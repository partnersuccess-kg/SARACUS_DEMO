{"job":{"components":{"69152":{"id":69152,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-80,"y":-208,"width":32,"height":32,"inputConnectorIDs":[69157],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Build Tables Script"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = curscreate.rolehone('SYSADMIN'mport json\n\nvScript = \"\"\"\nUSE ROLE SYSADMIN;\nUSE WAREHOUSE BUILD_WH;\nUSE DATABASE TEST_BRYAN;\nUSE SCHEMA EXTRACT_NUCLEUS_PERSONAL_LINES;\n\nCREATE OR REPLACE VIEW v_EXTRACT_TYPE_TEST AS\nWITH etables(table_name)\n     AS (SELECT TABLE_NAME\n         FROM information_schema.tables t\n         WHERE t.table_schema = 'EXTRACT_NUCLEUS_PERSONAL_LINES'\n               AND t.table_type = 'BASE TABLE'\n        AND\n        EXISTS\n        (\n            SELECT 1\n            FROM information_schema.tables t2\n            WHERE t2.table_name = 'V_STRING_' || t.table_name\n               AND t2.table_type = 'VIEW'\n        )\n    )\n     SELECT c.column_name, \n            c.table_name, \n            c.data_type || ' (' || CASE WHEN c.is_nullable = 'YES' THEN 'NULL' ELSE 'NOT NULL' END || ')' DATA_TYPE, \n            c.is_nullable, \n            'V_STRING_' || c.table_name view_name,\n            CASE\n                WHEN DATA_TYPE = 'BOOLEAN'\n                THEN 'TRY_TO_BOOLEAN'\n                WHEN DATA_TYPE = 'DOUBLE'\n                THEN 'TRY_TO_DOUBLE'\n                WHEN DATA_TYPE LIKE '%DATE%'\n                THEN 'TRY_TO_DATE'\n                WHEN DATA_TYPE = 'TIME'\n                THEN 'TRY_TO_TIME'\n                WHEN DATA_TYPE = 'BINARY'\n                THEN 'TRY_TO_BINARY'\n                WHEN DATA_TYPE LIKE '%TIMESTAMP%'\n                THEN 'TRY_TO_TIMESTAMP'\n                WHEN DATA_TYPE = 'DECIMAL'\n                THEN 'TRY_TO_DECIMAL'\n                WHEN DATA_TYPE LIKE 'NUMBER'\n                THEN 'TRY_TO_NUMBER'\n                WHEN DATA_TYPE LIKE 'NUMERIC'\n                THEN 'TRY_TO_NUMERIC'\n                WHEN DATA_TYPE = 'FLOAT'\n                THEN 'TRY_TO_NUMBER'\n                WHEN DATA_TYPE = 'TEXT'\n                THEN 'LOWER' -- a dummy test; really only testing for null value in a not null field\n                ELSE ''\n            END type_test,\n            CASE\n                WHEN DATA_TYPE = 'BOOLEAN'\n                THEN 'FALSE'\n                WHEN DATA_TYPE = 'DOUBLE'\n                THEN '0.0'\n                WHEN DATA_TYPE LIKE '%DATE%'\n                THEN '1/1/2000'\n                WHEN DATA_TYPE = 'TIME'\n                THEN '12:01:00'\n                WHEN DATA_TYPE = 'BINARY'\n                THEN '0'\n                WHEN DATA_TYPE LIKE '%TIMESTAMP%'\n                THEN '1/1/2000 12:01:00'\n                WHEN DATA_TYPE = 'DECIMAL'\n                THEN '1.0'\n                WHEN DATA_TYPE LIKE 'NUMBER'\n                THEN '1'\n                WHEN DATA_TYPE LIKE 'NUMERIC'\n                THEN '1'\n                WHEN DATA_TYPE = 'FLOAT'\n                THEN '1.0'\n                WHEN DATA_TYPE = 'TEXT'\n                THEN ''\n                ELSE ''\n            END type_test_default_null_value\n     FROM etables\n          INNER JOIN information_schema.columns c ON etables.table_name = c.table_name\n     WHERE (c.data_type <> 'TEXT' OR c.is_nullable = 'NO') AND c.table_schema = 'EXTRACT_NUCLEUS_PERSONAL_LINES'\n        \n     ORDER BY c.data_type, \n              c.table_name, \n              c.column_name;\nCREATE OR REPLACE VIEW V_EXTRACT_TYPE_TEST_SQL AS\nSELECT\nCASE WHEN TYPE_TEST <> '' THEN\n    CASE WHEN IS_NULLABLE = 'YES'\n        THEN 'INSERT INTO EXTRACT_NUCLEUS_TYPE_ERROR SELECT ''' || TABLE_NAME || ''' TABLE_NAME, ''' || COLUMN_NAME || ''' COLUMN_NAME, ''' || DATA_TYPE || ''' DATA_TYPE, ' ||  \n                COLUMN_NAME || ', CAST(current_timestamp() AS timestamp_ntz) FROM ' || VIEW_NAME || ' WHERE ' || TYPE_TEST || '(IFNULL(' || COLUMN_NAME || ',''' || TYPE_TEST_DEFAULT_NULL_VALUE || ''')) IS NULL;'\n        ELSE 'INSERT INTO EXTRACT_NUCLEUS_TYPE_ERROR SELECT ''' || TABLE_NAME || ''' TABLE_NAME, ''' || COLUMN_NAME || ''' COLUMN_NAME, ''' || DATA_TYPE || ''' DATA_TYPE, ' || \n                'CASE WHEN ' || COLUMN_NAME || ' = '''' THEN ''NULL'' ELSE ' || COLUMN_NAME || ' END, CAST(current_timestamp() AS timestamp_ntz) FROM ' || VIEW_NAME || ' WHERE ' || TYPE_TEST || '(' || COLUMN_NAME || ') IS NULL;'\n        END\n    ELSE\n        'INSERT INTO EXTRACT_NUCLEUS_TYPE_ERROR SELECT ''' || TABLE_NAME || ', ' || COLUMN_NAME || ', ' || DATA_TYPE || ', ''NO TEST AVAILABLE FOR THIS TYPE'', '''', CAST(current_timestamp() AS timestamp_ntz); ' \n    END\n    test_statement\nFROM V_EXTRACT_TYPE_TEST\nORDER BY data_type, table_name, column_name;\nCREATE OR REPLACE VIEW v_String_Assets AS\n\nSELECT\n    a.$1:\"id\"::STRING(4000) AS Asset_Id,\n    a.$1:\"createDate\"::STRING(4000) AS Asset_Created_Date,\n    a.$1:\"excessAsset\":\"address\":\"address\"::STRING(4000) AS ExcessAsset_Address_Address,\n    a.$1:\"excessAsset\":\"address\":\"address2\"::STRING(4000) AS ExcessAsset_Address_Address2,\n    a.$1:\"excessAsset\":\"address\":\"attributes\"::STRING(4000) AS ExcessAsset_Address_Attributes,\n    a.$1:\"excessAsset\":\"address\":\"city\"::STRING(4000) AS ExcessAsset_Address_City,\n    a.$1:\"excessAsset\":\"address\":\"county\"::STRING(4000) AS ExcessAsset_Address_County,\n    a.$1:\"excessAsset\":\"address\":\"fips\"::STRING(4000) AS ExcessAsset_Address_Fips,\n    a.$1:\"excessAsset\":\"address\":\"latitude\"::STRING(4000) AS ExcessAsset_Address_Latitude,\n    a.$1:\"excessAsset\":\"address\":\"longitude\"::STRING(4000) AS ExcessAsset_Address_Longitude,\n    a.$1:\"excessAsset\":\"address\":\"state\"::STRING(4000) AS ExcessAsset_Address_State,\n    a.$1:\"excessAsset\":\"address\":\"zip\"::STRING(4000) AS ExcessAsset_Address_Zip,\n    a.$1:\"excessAsset\":\"auxiliaryEngine\"::STRING(4000) AS ExcessAsset_AuxiliaryEngine,\n    a.$1:\"excessAsset\":\"cc\"::STRING(4000) AS ExcessAsset_Cc,\n    a.$1:\"excessAsset\":\"currentCarrier\"::STRING(4000) AS ExcessAsset_CurrentCarrier,\n    a.$1:\"excessAsset\":\"exessAssetType\"::STRING(4000) AS ExcessAsset_ExessAssetType,\n    a.$1:\"excessAsset\":\"exotic\":\"details\"::STRING(4000) AS ExcessAsset_Exotic_Details,\n    a.$1:\"excessAsset\":\"exotic\":\"present\"::STRING(4000) AS ExcessAsset_Exotic_Present,\n    a.$1:\"excessAsset\":\"hp\"::STRING(4000) AS ExcessAsset_Hp,\n    a.$1:\"excessAsset\":\"length\"::STRING(4000) AS ExcessAsset_Length,\n    a.$1:\"excessAsset\":\"liabilityLimit\"::STRING(4000) AS ExcessAsset_LiabilityLimit,\n    a.$1:\"excessAsset\":\"liabilityType\"::STRING(4000) AS ExcessAsset_LiabilityType,\n    a.$1:\"excessAsset\":\"make\"::STRING(4000) AS ExcessAsset_Make,\n    a.$1:\"excessAsset\":\"maxSpeed\"::STRING(4000) AS ExcessAsset_MaxSpeed,\n    a.$1:\"excessAsset\":\"model\"::STRING(4000) AS ExcessAsset_Model,\n    a.$1:\"excessAsset\":\"motorType\"::STRING(4000) AS ExcessAsset_MotorType,\n    a.$1:\"excessAsset\":\"numberOfFamilies\"::STRING(4000) AS ExcessAsset_NumberOfFamilies,\n    a.$1:\"excessAsset\":\"occupancyStatus\"::STRING(4000) AS ExcessAsset_OccupancyStatus,\n    a.$1:\"excessAsset\":\"policyNumber\"::STRING(4000) AS ExcessAsset_PolicyNumber,\n    a.$1:\"excessAsset\":\"rented\"::STRING(4000) AS ExcessAsset_Rented,\n    a.$1:\"excessAsset\":\"swimmingPool\":\"fence\"::STRING(4000) AS ExcessAsset_SwimmingPool_Fence,\n    a.$1:\"excessAsset\":\"swimmingPool\":\"present\"::STRING(4000) AS ExcessAsset_SwimmingPool_Present,\n    a.$1:\"excessAsset\":\"trampoline\":\"fence\"::STRING(4000) AS ExcessAsset_Trampoline_Fence,\n    a.$1:\"excessAsset\":\"trampoline\":\"present\"::STRING(4000) AS ExcessAsset_Trampoline_Present,\n    a.$1:\"excessAsset\":\"version\"::STRING(4000) AS ExcessAsset_Version,\n    a.$1:\"excessAsset\":\"year\"::STRING(4000) AS ExcessAsset_Year,\n    a.$1:\"line\"::STRING(4000) AS Asset_Line,\n    a.$1:\"policyId\"::STRING(4000) AS Policy_Id,\n    a.$1:\"property\":\"address\":\"address\"::STRING(4000) AS Property_Address_Address,\n    a.$1:\"property\":\"address\":\"attributes\"::STRING(4000) AS Property_Address_Attributes,\n    a.$1:\"property\":\"address\":\"city\"::STRING(4000) AS Property_Address_City,\n    a.$1:\"property\":\"address\":\"county\"::STRING(4000) AS Property_Address_County,\n    a.$1:\"property\":\"address\":\"fips\"::STRING(4000) AS Property_Address_Fips,\n    a.$1:\"property\":\"address\":\"id\"::STRING(4000) AS Property_Address_Id,\n    a.$1:\"property\":\"address\":\"latitude\"::STRING(4000) AS Property_Address_Latitude,\n    a.$1:\"property\":\"address\":\"longitude\"::STRING(4000) AS Property_Address_Longitude,\n    a.$1:\"property\":\"address\":\"state\"::STRING(4000) AS Property_Address_State,\n    a.$1:\"property\":\"address\":\"zip\"::STRING(4000) AS Property_Address_Zip,\n    a.$1:\"property\":\"personalLines\":\"addHOM012\"::STRING(4000) AS Property_PersonalLines_AddHOM012,\n    a.$1:\"property\":\"personalLines\":\"animals\":\"dogsOfBreeds\"::STRING(4000) AS Property_PersonalLines_Animals_DogsOfBreeds,\n    a.$1:\"property\":\"personalLines\":\"animals\":\"dogsWithBiteHistory\"::STRING(4000) AS Property_PersonalLines_Animals_DogsWithBiteHistory,\n    a.$1:\"property\":\"personalLines\":\"animals\":\"exotic\":\"details\"::STRING(4000) AS Property_PersonalLines_Animals_Exotic_Details,\n    a.$1:\"property\":\"personalLines\":\"animals\":\"exotic\":\"present\"::STRING(4000) AS Property_PersonalLines_Animals_Exotic_Present,\n    a.$1:\"property\":\"personalLines\":\"animals\":\"horses\":\"count\"::STRING(4000) AS Property_PersonalLines_Animals_Horses_Count,\n    a.$1:\"property\":\"personalLines\":\"animals\":\"horses\":\"present\"::STRING(4000) AS Property_PersonalLines_Animals_Horses_Present,\n    a.$1:\"property\":\"personalLines\":\"animals\":\"present\"::STRING(4000) AS Property_PersonalLines_Animals_Present,\n    a.$1:\"property\":\"personalLines\":\"businessOnPremises\"::STRING(4000) AS Property_PersonalLines_BusinessOnPremises,\n    a.$1:\"property\":\"personalLines\":\"clueRequested\"::STRING(4000) AS Property_PersonalLines_ClueRequested, \n    a.$1:\"property\":\"personalLines\":\"construction\":\"logs\":\"handHewn\"::STRING(4000) AS Property_PersonalLines_Construction_Logs_HandHewn,\n    a.$1:\"property\":\"personalLines\":\"construction\":\"logs\":\"uniformSize\"::STRING(4000) AS Property_PersonalLines_Construction_Logs_UniformSize,\n    a.$1:\"property\":\"personalLines\":\"construction\":\"type\"::STRING(4000) AS Property_PersonalLines_Construction_Type,\n    a.$1:\"property\":\"personalLines\":\"dwellingConverted\"::STRING(4000) AS Property_PersonalLines_DwellingConverted,\n    a.$1:\"property\":\"personalLines\":\"extPaintRenoType\"::STRING(4000) AS Property_PersonalLines_ExtPaintRenoType,\n    a.$1:\"property\":\"personalLines\":\"extPaintRenoYear\"::STRING(4000) AS Property_PersonalLines_ExtPaintRenoYear,\n    a.$1:\"property\":\"personalLines\":\"exteriorWallFinish\"::STRING(4000) AS Property_PersonalLines_ExteriorWallFinish,\n    a.$1:\"property\":\"personalLines\":\"farFromPrimary\"::STRING(4000) AS Property_PersonalLines_FarFromPrimary,\n    a.$1:\"property\":\"personalLines\":\"foundationType\"::STRING(4000) AS Property_PersonalLines_FoundationType,\n    a.$1:\"property\":\"personalLines\":\"garage\":\"numberOfCars\"::STRING(4000) AS Property_PersonalLines_Garage_NumberOfCars,\n    a.$1:\"property\":\"personalLines\":\"garage\":\"present\"::STRING(4000) AS Property_PersonalLines_Garage_Present,\n    a.$1:\"property\":\"personalLines\":\"garage\":\"style\"::STRING(4000) AS Property_PersonalLines_Garage_Style,\n    a.$1:\"property\":\"personalLines\":\"garage\":\"type\"::STRING(4000) AS Property_PersonalLines_Garage_Type,\n    a.$1:\"property\":\"personalLines\":\"heating\":\"primary\"::STRING(4000) AS Property_PersonalLines_Heating_Primary,\n    a.$1:\"property\":\"personalLines\":\"heating\":\"woodStove\":\"inGarage\"::STRING(4000) AS Property_PersonalLines_Heating_WoodStove_InGarage,\n    a.$1:\"property\":\"personalLines\":\"heating\":\"woodStove\":\"present\"::STRING(4000) AS Property_PersonalLines_Heating_WoodStove_Present,\n    a.$1:\"property\":\"personalLines\":\"homeConstruction\":\"contractorLicense\"::STRING(4000) AS Property_PersonalLines_HomeConstruction_ContractorLicense,\n    a.$1:\"property\":\"personalLines\":\"homeConstruction\":\"contractorLicensed\"::STRING(4000) AS Property_PersonalLines_HomeConstruction_ContractorLicensed,\n    a.$1:\"property\":\"personalLines\":\"homeConstruction\":\"contractorName\"::STRING(4000) AS Property_PersonalLines_HomeConstruction_ContractorName,\n    a.$1:\"property\":\"personalLines\":\"homeConstruction\":\"courseOfConstruction\"::STRING(4000) AS Property_PersonalLines_HomeConstruction_CourseOfConstruction,\n    a.$1:\"property\":\"personalLines\":\"homeConstruction\":\"estEndDate\"::STRING(4000) AS Property_PersonalLines_HomeConstruction_EstEndDate,\n    a.$1:\"property\":\"personalLines\":\"homeConstruction\":\"startDate\"::STRING(4000) AS Property_PersonalLines_HomeConstruction_StartDate, \n    a.$1:\"property\":\"personalLines\":\"inCityLimits\"::STRING(4000) AS Property_PersonalLines_InCityLimits,\n    a.$1:\"property\":\"personalLines\":\"numFamilies\"::STRING(4000) AS Property_PersonalLines_NumFamilies,\n    a.$1:\"property\":\"personalLines\":\"occupancyStatus\"::STRING(4000) AS Property_PersonalLines_OccupancyStatus,\n    a.$1:\"property\":\"personalLines\":\"perilPremiums\":\"allPerils\"::STRING(4000) AS Property_PersonalLines_PerilPremiums_AllPerils,\n    a.$1:\"property\":\"personalLines\":\"perilPremiums\":\"fire\"::STRING(4000) AS Property_PersonalLines_PerilPremiums_Fire,\n    a.$1:\"property\":\"personalLines\":\"perilPremiums\":\"liability\"::STRING(4000) AS Property_PersonalLines_PerilPremiums_Liability,\n    a.$1:\"property\":\"personalLines\":\"perilPremiums\":\"otherProperty\"::STRING(4000) AS Property_PersonalLines_PerilPremiums_OtherProperty,\n    a.$1:\"property\":\"personalLines\":\"perilPremiums\":\"theft\"::STRING(4000) AS Property_PersonalLines_PerilPremiums_Theft,\n    a.$1:\"property\":\"personalLines\":\"perilPremiums\":\"water\"::STRING(4000) AS Property_PersonalLines_PerilPremiums_Water,\n    a.$1:\"property\":\"personalLines\":\"perilPremiums\":\"wind\"::STRING(4000) AS Property_PersonalLines_PerilPremiums_Wind,\n    a.$1:\"property\":\"personalLines\":\"protectionClass\":\"class\"::STRING(4000) AS Property_PersonalLines_ProtectionClass_Class,\n    a.$1:\"property\":\"personalLines\":\"protectionClass\":\"distanceFireHydrant\"::STRING(4000) AS Property_PersonalLines_ProtectionClass_DistanceFireHydrant,\n    a.$1:\"property\":\"personalLines\":\"protectionClass\":\"distanceFireStation\"::STRING(4000) AS Property_PersonalLines_ProtectionClass_DistanceFireStation,\n    a.$1:\"property\":\"personalLines\":\"protectionClass\":\"fireDistrictName\"::STRING(4000) AS Property_PersonalLines_ProtectionClass_FireDistrictName,\n    a.$1:\"property\":\"personalLines\":\"protectionClass\":\"fireDistrictSubscription\"::STRING(4000) AS Property_PersonalLines_ProtectionClass_FireDistrictSubscription,\n    a.$1:\"property\":\"personalLines\":\"protectionClass\":\"initial\"::STRING(4000) AS Property_PersonalLines_ProtectionClass_Initial,\n    a.$1:\"property\":\"personalLines\":\"protectionClass\":\"lastRequestDate\"::STRING(4000) AS Property_PersonalLines_ProtectionClass_LastRequestDate,\n    a.$1:\"property\":\"personalLines\":\"protectionClass\":\"override\"::STRING(4000) AS Property_PersonalLines_ProtectionClass_Override,\n    a.$1:\"property\":\"personalLines\":\"protectionDevice\":\"burglar\"::STRING(4000) AS Property_PersonalLines_ProtectionDevice_Burglar,\n    a.$1:\"property\":\"personalLines\":\"protectionDevice\":\"fire\"::STRING(4000) AS Property_PersonalLines_ProtectionDevice_Fire,\n    a.$1:\"property\":\"personalLines\":\"protectionDevice\":\"smoke\"::STRING(4000) AS Property_PersonalLines_ProtectionDevice_Smoke,\n    a.$1:\"property\":\"personalLines\":\"protectionDevice\":\"sprinkler\"::STRING(4000) AS Property_PersonalLines_ProtectionDevice_Sprinkler,\n    a.$1:\"property\":\"personalLines\":\"residenceType\"::STRING(4000) AS Property_PersonalLines_Residence_Type,\n    a.$1:\"property\":\"personalLines\":\"riskScores\":\"hail\":\"date\"::STRING(4000) AS Property_PersonalLines_RiskScores_Hail_Date,\n    a.$1:\"property\":\"personalLines\":\"riskScores\":\"hail\":\"id\"::STRING(4000) AS Property_PersonalLines_RiskScores_Hail_Id,\n    a.$1:\"property\":\"personalLines\":\"riskScores\":\"hail\":\"score\"::STRING(4000) AS Property_PersonalLines_RiskScores_Hail_Score,\n    a.$1:\"property\":\"personalLines\":\"riskScores\":\"hailDamage\":\"date\"::STRING(4000) AS Property_PersonalLines_RiskScores_HailDamage_Date,\n    a.$1:\"property\":\"personalLines\":\"riskScores\":\"hailDamage\":\"id\"::STRING(4000) AS Property_PersonalLines_RiskScores_HailDamage_Id,\n    a.$1:\"property\":\"personalLines\":\"riskScores\":\"hailDamage\":\"score\"::STRING(4000) AS Property_PersonalLines_RiskScores_HailDamage_Score,\n    a.$1:\"property\":\"personalLines\":\"riskScores\":\"wildfire\":\"date\"::STRING(4000) AS Property_PersonalLines_RiskScores_Wildfire_Date,\n    a.$1:\"property\":\"personalLines\":\"riskScores\":\"wildfire\":\"id\"::STRING(4000) AS Property_PersonalLines_RiskScores_Wildfire_Id,\n    a.$1:\"property\":\"personalLines\":\"riskScores\":\"wildfire\":\"score\"::STRING(4000) AS Property_PersonalLines_RiskScores_Wildfire_Score,\n    a.$1:\"property\":\"personalLines\":\"roof\":\"age\"::STRING(4000) AS Property_PersonalLines_Roof_Age,\n    a.$1:\"property\":\"personalLines\":\"roof\":\"type\"::STRING(4000) AS Property_PersonalLines_Roof_Type,\n    a.$1:\"property\":\"personalLines\":\"sqFt\"::STRING(4000) AS Property_PersonalLines_SqFt,\n    a.$1:\"property\":\"personalLines\":\"stories\"::STRING(4000) AS Property_PersonalLines_Stories,\n    a.$1:\"property\":\"personalLines\":\"style\"::STRING(4000) AS Property_PersonalLines_Style,\n    a.$1:\"property\":\"personalLines\":\"swimmingPool\":\"fence\"::STRING(4000) AS Property_PersonalLines_SwimmingPool_Fence,\n    a.$1:\"property\":\"personalLines\":\"swimmingPool\":\"present\"::STRING(4000) AS Property_PersonalLines_SwimmingPool_Present,\n    a.$1:\"property\":\"personalLines\":\"territories\":\"fire\"::STRING(4000) AS Property_PersonalLines_Territories_Fire,\n    a.$1:\"property\":\"personalLines\":\"territories\":\"liability\"::STRING(4000) AS Property_PersonalLines_Territories_Liability,\n    a.$1:\"property\":\"personalLines\":\"territories\":\"otherProperty\"::STRING(4000) AS Property_PersonalLines_Territories_OtherProperty,\n    a.$1:\"property\":\"personalLines\":\"territories\":\"theft\"::STRING(4000) AS Property_PersonalLines_Territories_Theft,\n    a.$1:\"property\":\"personalLines\":\"territories\":\"water\"::STRING(4000) AS Property_PersonalLines_Territories_Water,\n    a.$1:\"property\":\"personalLines\":\"territories\":\"wind\"::STRING(4000) AS Property_PersonalLines_Territories_Wind,\n    a.$1:\"property\":\"personalLines\":\"territory\"::STRING(4000) AS Property_PersonalLines_Territory,\n    a.$1:\"property\":\"personalLines\":\"value360Lookup\":\"rcv\"::STRING(4000) AS Property_PersonalLines_Value360Lookup_Rcv,\n    a.$1:\"property\":\"personalLines\":\"value360Lookup\":\"rcvMessage\"::STRING(4000) AS Property_PersonalLines_Value360Lookup_Rcv_Message,\n    a.$1:\"property\":\"personalLines\":\"value360Lookup\":\"valuationID\"::STRING(4000) AS Property_PersonalLines_Value360Lookup_ValuationID,\n    a.$1:\"property\":\"personalLines\":\"wiring\":\"circuitBreaker\"::STRING(4000) AS Property_PersonalLines_Wiring_CircuitBreaker,\n    a.$1:\"property\":\"personalLines\":\"wiring\":\"circuitBreakers\"::STRING(4000) AS Property_PersonalLines_Wiring_CircuitBreakers,\n    a.$1:\"property\":\"personalLines\":\"wiring\":\"knobAndTube\"::STRING(4000) AS Property_PersonalLines_Wiring_KnobAndTube,\n    a.$1:\"property\":\"personalLines\":\"yearBuilt\"::STRING(4000) AS Property_PersonalLines_YearBuilt,\n    a.$1:\"property\":\"version\"::STRING(4000) AS Property_Version,\n    a.$1:\"sortOrder\"::STRING(4000) AS Sort_Order,\n    a.$1:\"status\"::STRING(4000) AS Status,\n    a.$1:\"subline\"::STRING(4000) AS Subline,\n    a.$1:\"termPremium\"::STRING(4000) AS Term_Premium,\n    a.$1:\"totalPremium\"::STRING(4000) AS Total_Premium,\n    a.$1:\"type\"::STRING(4000) AS Type,\n    a.$1:\"UnitNumber\"::STRING(4000) AS Unit_Number_Mistyped,\n    a.$1:\"unitNumber\"::STRING(4000) AS Unit_Number,\n    a.$1:\"updateToken\"::STRING(4000) AS Update_Token,\n    a.$1:\"vehicle\":\"calculatedFields\":\"biPdSymbol\"::STRING(4000) AS Vehicle_CalculatedFields_BiPdSymbol,\n    a.$1:\"vehicle\":\"calculatedFields\":\"collisionSymbol\"::STRING(4000) AS Vehicle_CalculatedFields_CollisionSymbol,\n    a.$1:\"vehicle\":\"calculatedFields\":\"comprehensiveSymbol\"::STRING(4000) AS Vehicle_CalculatedFields_ComprehensiveSymbol,\n    a.$1:\"vehicle\":\"calculatedFields\":\"pipMedSymbol\"::STRING(4000) AS Vehicle_CalculatedFields_PipMedSymbol,\n    a.$1:\"vehicle\":\"garageLocation\"::STRING(4000) AS Vehicle_GarageLocation,\n    a.$1:\"vehicle\":\"haveVin\"::STRING(4000) AS Vehicle_Have_Vin,\n    a.$1:\"vehicle\":\"make\"::STRING(4000) AS Vehicle_Make,\n    a.$1:\"vehicle\":\"model\"::STRING(4000) AS Vehicle_Model,\n    a.$1:\"vehicle\":\"personalLines\":\"additionalSymbol\"::STRING(4000) AS Vehicle_PersonalLines_AdditionalSymbol,\n    a.$1:\"vehicle\":\"personalLines\":\"additionalVINDetails\":\"antiLockBrakes\"::STRING(4000) AS Vehicle_PersonalLines_AdditionalVINDetails_AntiLockBrakes,\n    a.$1:\"vehicle\":\"personalLines\":\"additionalVINDetails\":\"bodyType\"::STRING(4000) AS Vehicle_PersonalLines_AdditionalVINDetails_BodyType,\n    a.$1:\"vehicle\":\"personalLines\":\"additionalVINDetails\":\"cylinders\"::STRING(4000) AS Vehicle_PersonalLines_AdditionalVINDetails_Cylinders,\n    a.$1:\"vehicle\":\"personalLines\":\"additionalVINDetails\":\"driveWheels\"::STRING(4000) AS Vehicle_PersonalLines_AdditionalVINDetails_DriveWheels,\n    a.$1:\"vehicle\":\"personalLines\":\"additionalVINDetails\":\"engineDisplacement\"::STRING(4000) AS Vehicle_PersonalLines_AdditionalVINDetails_EngineDisplacement,\n    a.$1:\"vehicle\":\"personalLines\":\"additionalVINDetails\":\"lastVINCheckDate\"::STRING(4000) AS Vehicle_PersonalLines_AdditionalVINDetails_LastVINCheckDate,\n    a.$1:\"vehicle\":\"personalLines\":\"additionalVINDetails\":\"length\"::STRING(4000) AS Vehicle_PersonalLines_AdditionalVINDetails_Length,\n    a.$1:\"vehicle\":\"personalLines\":\"additionalVINDetails\":\"motorcycleType\"::STRING(4000) AS Vehicle_PersonalLines_AdditionalVINDetails_MotorcycleType,\n    a.$1:\"vehicle\":\"personalLines\":\"additionalVINDetails\":\"passiveBelts\"::STRING(4000) AS Vehicle_PersonalLines_AdditionalVINDetails_PassiveBelts,\n    a.$1:\"vehicle\":\"personalLines\":\"additionalVINDetails\":\"preformance\"::STRING(4000) AS Vehicle_PersonalLines_AdditionalVINDetails_Preformance,\n    a.$1:\"vehicle\":\"personalLines\":\"additionalVINDetails\":\"subType\"::STRING(4000) AS Vehicle_PersonalLines_AdditionalVINDetails_SubType,\n    a.$1:\"vehicle\":\"personalLines\":\"additionalVINDetails\":\"vehicleClassDesc\"::STRING(4000) AS Vehicle_PersonalLines_AdditionalVINDetails_VehicleClassDesc,\n    a.$1:\"vehicle\":\"personalLines\":\"additionalVINDetails\":\"vinTStatus\"::STRING(4000) AS Vehicle_PersonalLines_AdditionalVINDetails_VinTStatus,\n    a.$1:\"vehicle\":\"personalLines\":\"annualMiles\"::STRING(4000) AS Vehicle_PersonalLines_AnnualMiles,\n    a.$1:\"vehicle\":\"personalLines\":\"antiTheftDevice\"::STRING(4000) AS Vehicle_PersonalLines_AntiTheftDevice,\n    a.$1:\"vehicle\":\"personalLines\":\"compOnly\"::STRING(4000) AS Vehicle_PersonalLines_CompOnly,\n    a.$1:\"vehicle\":\"personalLines\":\"costNew\"::STRING(4000) AS Vehicle_PersonalLines_CostNew,\n    a.$1:\"vehicle\":\"personalLines\":\"ownership\"::STRING(4000) AS Vehicle_PersonalLines_Ownership,\n    a.$1:\"vehicle\":\"personalLines\":\"purchaseDate\"::STRING(4000) AS Vehicle_PersonalLines_PurchaseDate,\n    a.$1:\"vehicle\":\"personalLines\":\"usage\"::STRING(4000) AS Vehicle_PersonalLines_Usage,\n    a.$1:\"vehicle\":\"vehicleType\"::STRING(4000) AS Vehicle_Type,\n    a.$1:\"vehicle\":\"version\"::STRING(4000) AS Vehicle_Version,\n    a.$1:\"vehicle\":\"vin\"::STRING(4000) AS Vehicle_Vin,\n    a.$1:\"vehicle\":\"year\"::STRING(4000) AS Vehicle_Year,\n    a.$1:\"version\"::STRING(4000) AS Version,\n    a.$2 AS Filename,\n    a.$3 AS File_Datetime\n\nFROM\n\t\"NUCLEUS_ASSETS\" a;\n\nCREATE OR REPLACE VIEW v_String_Asset_Coverages AS\nSELECT\n    a.$1:\"policyId\"::STRING(4000) AS Policy_Id,\n    a.$1:\"sortOrder\"::STRING(4000) AS Sort_Order,\n    a.$1:\"id\"::STRING(4000) AS Asset_Id,\n    coverages.value:\"accountingDate\"::STRING(4000) AS Coverages_Accounting_Date,\n    coverages.value:\"code\"::STRING(4000) AS Coverages_Code,\n    coverages.value:\"comments\"::STRING(4000) AS Coverages_Comments,\n    coverages.value:\"commission\"::STRING(4000) AS Coverages_Commission,\n    coverages.value:\"commissionChange\"::STRING(4000) AS Coverages_Commission_Change,\n    coverages.value:\"covCode\"::STRING(4000) AS Coverages_Cov_Code,\n    coverages.value:\"coverageDescription\"::STRING(4000) AS Coverages_Coverage_Description,\n    coverages.value:\"description\"::STRING(4000) AS Coverages_Description,\n    coverages.value:\"displayOrder\"::STRING(4000) AS Coverages_Display_Order,\n    coverages.value:\"displayValue\"::STRING(4000) AS Coverages_Display_Value,\n    coverages.value:\"earnedPremium\"::STRING(4000) AS Coverages_Earned_Premium,\n    coverages.value:\"formNumber\"::STRING(4000) AS Coverages_Form_Number,\n    coverages.value:\"id\"::STRING(4000) AS Coverages_Id,\n    coverages.value:\"isLimit\"::STRING(4000) AS Coverages_Is_Limit,\n    coverages.value:\"isRented\"::STRING(4000) AS Coverages_Is_Rented,\n    coverages.value:\"length\"::STRING(4000) AS Coverages_Length,\n    coverages.value:\"numberOfFamilies\"::STRING(4000) AS Coverages_Number_Of_Families,\n    coverages.value:\"parentFormType\"::STRING(4000) AS Coverages_Parent_Form_Type,\n    coverages.value:\"rate\"::STRING(4000) AS Coverages_Rate,\n    coverages.value:\"rateChange\"::STRING(4000) AS Coverages_Rate_Change,\n    coverages.value:\"recVehicle\":\"horsepowerCC\"::STRING(4000) AS Coverages_Rec_Vehicle_Horsepower_CC,\n    coverages.value:\"recVehicle\":\"makeModel\"::STRING(4000) AS Coverages_Rec_Vehicle_Make_Model,\n    coverages.value:\"recVehicle\":\"serialNumber\"::STRING(4000) AS Coverages_Rec_Vehicle_Serial_Number,\n    coverages.value:\"recVehicle\":\"version\"::STRING(4000) AS Coverages_Rec_Vehicle_Version,\n    coverages.value:\"sortOrder\"::STRING(4000) AS Coverages_Sort_Order,\n    coverages.value:\"termPremium\"::STRING(4000) AS Coverages_Term_Premium,\n    coverages.value:\"termPremiumChange\"::STRING(4000) AS Coverages_Term_Premium_Change,\n    coverages.value:\"value\"::STRING(4000) AS Coverages_Value,\n    coverages.value:\"valueType\"::STRING(4000) AS Coverages_Value_Type,\n    coverages.value:\"version\"::STRING(4000) AS Coverages_Version,\n    coverages.value:\"watercraft\":\"cc\"::STRING(4000) AS Coverages_Watercraft_CC,\n    coverages.value:\"watercraft\":\"horsepower\"::STRING(4000) AS Coverages_Watercraft_Horsepower,\n    coverages.value:\"watercraft\":\"length\"::STRING(4000) AS Coverages_Watercraft_Length,\n    coverages.value:\"watercraft\":\"manufacturer\"::STRING(4000) AS Coverages_Watercraft_Manufacturer,\n    coverages.value:\"watercraft\":\"model\"::STRING(4000) AS Coverages_Watercraft_Model,\n    coverages.value:\"watercraft\":\"propulsionTypeCode\"::STRING(4000) AS Coverages_Watercraft_Propulsion_Type_Code,\n    coverages.value:\"watercraft\":\"speed\"::STRING(4000) AS Coverages_Watercraft_Speed,\n    coverages.value:\"watercraft\":\"version\"::STRING(4000) AS Coverages_Watercraft_Version,\n    coverages.value:\"watercraft\":\"year\"::STRING(4000) AS Coverages_Watercraft_Year,\n    coverages.value:\"width\"::STRING(4000) AS Coverages_Width,\n    coverages.value:\"writtenPremium\"::STRING(4000) AS Coverages_Written_Premium,\n    coverages.value:\"writtenPremiumChange\"::STRING(4000) AS Coverages_Written_Premium_Change\nFROM\n\t\"NUCLEUS_ASSETS\" a,\n\tTABLE(FLATTEN(INPUT => a.$1, path => 'coverages')) coverages;\nCREATE OR REPLACE VIEW v_String_Asset_Coverages_Additional_Billing AS\nSELECT\n      a.$1:\"id\"::STRING(4000) AS Asset_Id,\n      coverages.value:\"id\"::STRING(4000) AS Coverage_Id,\n      additionalBilling.value:\"commission\"::STRING(4000) AS Additional_Billing_Coverage_Commission,\n      additionalBilling.value:\"commissionChange\"::STRING(4000) AS Additional_Billing_Coverage_Commission_Change,\n      additionalBilling.value:\"description\"::STRING(4000) AS Additional_Billing_Description,\n      additionalBilling.value:\"earnedPremium\"::STRING(4000) AS Additional_Billing_Earned_Premium,\n      additionalBilling.value:\"rate\"::STRING(4000) AS Additional_Billing_Rate,\n      additionalBilling.value:\"rateChange\"::STRING(4000) AS Additional_Billing_Rate_Change,\n      additionalBilling.value:\"termPremium\"::STRING(4000) AS Additional_Billing_Term_Premium,\n      additionalBilling.value:\"termPremiumChange\"::STRING(4000) AS Additional_Billing_Term_Premium_Change,\n      additionalBilling.value:\"writtenPremium\"::STRING(4000) AS Additional_Billing_Written_Premium,\n      additionalBilling.value:\"writtenPremiumChange\"::STRING(4000) AS Additional_Billing_Written_Premium_Change\n\nFROM\n\t\"NUCLEUS_ASSETS\" a,\n\tTABLE(FLATTEN(INPUT => a.$1, path => 'coverages')) coverages,\n    TABLE(FLATTEN(INPUT => coverages.value:\"additionalBilling\")) additionalBilling;\nCREATE OR REPLACE VIEW v_String_Asset_Coverages_Addresses AS\nSELECT\n      a.$1:\"id\"::STRING(4000) AS Asset_Id,\n      coverages.value:\"id\"::STRING(4000) AS Coverage_Id,\n      addresses.value:\"address\"::STRING(4000) AS Address,\n      addresses.value:\"city\"::STRING(4000) AS City,\n      addresses.value:\"county\"::STRING(4000) AS County,\n      addresses.value:\"fips\"::STRING(4000) AS Fips,\n      addresses.value:\"latitude\"::STRING(4000) AS Latitude,\n      addresses.value:\"longitude\"::STRING(4000) AS Longitude,\n      addresses.value:\"state\"::STRING(4000) AS State,\n      addresses.value:\"zip\"::STRING(4000) AS Zipcode,\n      addresses.value:\"id\"::STRING(4000) AS Address_Id\nFROM\n      \"NUCLEUS_ASSETS\" a,\n\tTABLE(FLATTEN(INPUT => a.$1, path => 'coverages')) coverages,\n    TABLE(FLATTEN(INPUT => coverages.value:\"addresses\")) addresses;\nCREATE OR REPLACE VIEW v_String_Asset_Coverages_Questions AS\nSELECT\n      a.$1:\"id\"::STRING(4000) AS Asset_Id,\n      coverages.value:\"id\"::STRING(4000) AS Coverage_Id,\n      questions.value:\"answer\"::STRING(4000) AS Questions_Answer,\n      questions.value:\"id\"::STRING(4000) AS Questions_Id,\n      questions.value:\"version\"::STRING(4000) AS Questions_Version\nFROM\n\t\"NUCLEUS_ASSETS\" a,\n\tTABLE(FLATTEN(INPUT => a.$1, path => 'coverages')) coverages,\n    TABLE(FLATTEN(INPUT => coverages.value:\"questions\")) questions;\nCREATE OR REPLACE VIEW v_String_Asset_Coverages_Scheduled_Items AS\nSELECT\n      a.$1:\"id\"::STRING(4000) AS Asset_Id,\n      coverages.value:\"id\"::STRING(4000) AS Coverage_Id,\n      scheduledItems.value:\"agreedCoverageValue\"::STRING(4000) AS Scheduled_Items_Agreed_Coverage_Value,\n      scheduledItems.value:\"amount\"::STRING(4000) AS Scheduled_Items_Amount,\n      scheduledItems.value:\"breakageCoverage\"::STRING(4000) AS Scheduled_Items_Breakage_Coverage,\n      scheduledItems.value:\"description\"::STRING(4000) AS Scheduled_Items_Description,\n      scheduledItems.value:\"id\"::STRING(4000) AS Scheduled_Items_Id,\n      scheduledItems.value:\"isInstrumentForBusiness\"::STRING(4000) AS Scheduled_Items_Is_Instrument_For_Business,\n      scheduledItems.value:\"propertyClassCode\"::STRING(4000) AS Scheduled_Items_Property_Class_Code,\n      scheduledItems.value:\"version\"::STRING(4000) AS Scheduled_Items_Version\nFROM\n\t\"NUCLEUS_ASSETS\" a,\n\tTABLE(FLATTEN(INPUT => a.$1, path => 'coverages')) coverages,\n    TABLE(FLATTEN(INPUT => coverages.value:\"scheduledItems\")) scheduledItems;\nCREATE OR REPLACE VIEW v_String_Asset_NA_Coverages AS\nSELECT\n\ta.$1:\"id\"::STRING(4000) AS Asset_Id,\n\tnaCoverages.value:\"code\"::STRING(4000) AS NA_Coverage_Code,\n\tnaCoverages.value:\"coverageDescription\"::STRING(4000) AS NA_Coverages_Coverage_Description,\n\tnaCoverages.value:\"description\"::STRING(4000) AS NA_Coverages_Description,\n    naCoverages.value:\"displayOrder\"::STRING(4000) AS NA_Coverages_Display_Order,\n\tnaCoverages.value:\"id\"::STRING(4000) AS NA_Coverages_Id,\n\tnaCoverages.value:\"isLimit\"::STRING(4000) AS NA_Coverages_Is_Limit,\n\tnaCoverages.value:\"rate\"::STRING(4000) AS NA_Coverages_Rate,\n    naCoverages.value:\"termPremium\"::STRING(4000) AS NA_Coverages_Term_Premium,\n    naCoverages.value:\"value\"::STRING(4000) AS NA_Coverages_Value,\n    naCoverages.value:\"valueType\"::STRING(4000) AS NA_Coverages_Value_Type,\n\tnaCoverages.value:\"version\"::STRING(4000) AS NA_Coverages_Version\nFROM\n\t\"NUCLEUS_ASSETS\" a,\n\tTABLE(FLATTEN(INPUT => a.$1, path => 'notApplicableCoverages')) naCoverages;\nCREATE OR REPLACE VIEW v_String_Asset_Property_Interests AS\nSELECT\n\ta.$1:\"id\"::STRING(4000) AS Asset_Id,\n\tinterests.value:\"address\".\"address\"::STRING(4000) AS Interests_Address,\n\tinterests.value:\"address\".\"attributes\".\"interest\"::STRING(4000) AS Interests_Attributes_Interests,\n\tinterests.value:\"address\".\"city\"::STRING(4000) AS Interest_City,\n\tinterests.value:\"address\".\"state\"::STRING(4000) AS Interest_State,\n\tinterests.value:\"address\".\"zip\"::STRING(4000) AS Interest_Zipcode,\n\tinterests.value:\"id\"::STRING(4000) AS Interest_Id,\n\tinterests.value:\"isPayer\"::STRING(4000) AS Interest_Is_Payer,\n    interests.value:\"loanNumber\"::STRING(4000) AS Interest_Loan_Number,\n\tinterests.value:\"name\"::STRING(4000) AS Interest_Name,\n\tinterests.value:\"name2\"::STRING(4000) AS Interest_Name2,\n\tinterests.value:\"name3\"::STRING(4000) AS Interest_Name3,\n\tinterests.value:\"type\"::STRING(4000) AS Interest_Type,\n\tinterests.value:\"version\"::STRING(4000) AS Interest_Version\nFROM\n\t\"NUCLEUS_ASSETS\" a,\n\tTABLE(FLATTEN(INPUT => a.$1:\"property\":\"interests\")) interests;\nCREATE OR REPLACE VIEW v_String_Asset_Removed_Coverages AS\nSELECT\n    a.$1:\"id\"::STRING(4000) AS Asset_Id,\n    removedcoverages.value:\"accountingDate\"::STRING(4000) AS Removed_Coverages_Accounting_Date,\n    removedcoverages.value:\"code\"::STRING(4000) AS Removed_Coverages_Code,\n    removedcoverages.value:\"commission\"::STRING(4000) AS Removed_Coverages_Commission,\n    removedcoverages.value:\"commissionChange\"::STRING(4000) AS Removed_Coverages_Commission_Change,\n    removedcoverages.value:\"covCode\"::STRING(4000) AS Removed_Coverages_Cov_Code,\n    removedcoverages.value:\"coverageDescription\"::STRING(4000) AS Removed_Coverages_Coverage_Description,\n    removedcoverages.value:\"description\"::STRING(4000) AS Removed_Coverages_Description,\n    removedcoverages.value:\"earnedPremium\"::STRING(4000) AS Removed_Coverages_Earned_Premium,\n    removedcoverages.value:\"formNumber\"::STRING(4000) AS Removed_Coverages_Form_Number,\n    removedcoverages.value:\"id\"::STRING(4000) AS Removed_Coverages_Id,\n    removedcoverages.value:\"isLimit\"::STRING(4000) AS Removed_Coverages_Is_Limit,\n    removedcoverages.value:\"isRented\"::STRING(4000) AS Removed_Coverages_Is_Rented,\n    removedcoverages.value:\"parentFormType\"::STRING(4000) AS Removed_Coverages_Parent_Form_Type,\n    removedcoverages.value:\"rate\"::STRING(4000) AS Removed_Coverages_Rate,\n    removedcoverages.value:\"rateChange\"::STRING(4000) AS Removed_Coverages_Rate_Change,\n    removedcoverages.value:\"recVehicle\":\"horsepowerCC\"::STRING(4000) AS Removed_Coverages_Rec_Vehicle_Horsepower_CC,\n    removedcoverages.value:\"recVehicle\":\"makeModel\"::STRING(4000) AS Removed_Coverages_Rec_Vehicle_Make_Model,\n    removedcoverages.value:\"recVehicle\":\"serialNumber\"::STRING(4000) AS Removed_Coverages_Rec_Vehicle_Serial_Number,\n    removedcoverages.value:\"recVehicle\":\"version\"::STRING(4000) AS Removed_Coverages_Rec_Vehicle_Version,\n    removedcoverages.value:\"sortOrder\"::STRING(4000) AS Removed_Coverages_Sort_Order,\n    removedcoverages.value:\"value\"::STRING(4000) AS Removed_Coverages_Value,\n    removedcoverages.value:\"version\"::STRING(4000) AS Removed_Coverages_Version,\n    removedcoverages.value:\"watercraft\":\"cc\"::STRING(4000) AS Removed_Coverages_Watercraft_CC,\n    removedcoverages.value:\"watercraft\":\"horsepower\"::STRING(4000) AS Removed_Coverages_Watercraft_Horsepower,\n    removedcoverages.value:\"watercraft\":\"length\"::STRING(4000) AS Removed_Coverages_Watercraft_Length,\n    removedcoverages.value:\"watercraft\":\"manufacturer\"::STRING(4000) AS Removed_Coverages_Watercraft_Manufacturer,\n    removedcoverages.value:\"watercraft\":\"model\"::STRING(4000) AS Removed_Coverages_Watercraft_Model,\n    removedcoverages.value:\"watercraft\":\"propulsionTypeCode\"::STRING(4000) AS Removed_Coverages_Watercraft_Propulsion_Type_Code,\n    removedcoverages.value:\"watercraft\":\"speed\"::STRING(4000) AS Removed_Coverages_Watercraft_Speed,\n    removedcoverages.value:\"watercraft\":\"version\"::STRING(4000) AS Removed_Coverages_Watercraft_Version,\n    removedcoverages.value:\"watercraft\":\"year\"::STRING(4000) AS Removed_Coverages_Watercraft_Year,\n    removedcoverages.value:\"writtenPremium\"::STRING(4000) AS Removed_Coverages_Written_Premium,\n    removedcoverages.value:\"writtenPremiumChange\"::STRING(4000) AS Removed_Coverages_Written_Premium_Change\nFROM\n\t\"NUCLEUS_ASSETS\" a,\n\tTABLE(FLATTEN(INPUT => a.$1, path => 'removedCoverages')) removedcoverages;\n    CREATE OR REPLACE VIEW v_String_Asset_Removed_Coverages_Questions AS\nSELECT\n      a.$1:\"id\"::STRING(4000) AS Asset_Id,\n      removedcoverages.value:\"id\"::STRING(4000) AS Coverage_Id,\n      questions.value:\"answer\"::STRING(4000) AS Questions_Answer,\n      questions.value:\"id\"::STRING(4000) AS Questions_Id,\n      questions.value:\"version\"::STRING(4000) AS Questions_Version\nFROM\n\t\"NUCLEUS_ASSETS\" a,\n\tTABLE(FLATTEN(INPUT => a.$1, path => 'removedCoverages')) removedcoverages,\n    TABLE(FLATTEN(INPUT => removedcoverages.value:\"questions\")) questions;\nCREATE OR REPLACE VIEW v_String_Asset_Vehicle_Interests AS\nSELECT\n\ta.$1:\"id\"::STRING(4000) AS Asset_Id,\n\tinterests.value:\"address\".\"address\"::STRING(4000) AS Interests_Address,\n\tinterests.value:\"address\".\"attributes\".\"interest\"::STRING(4000) AS Interests_Attributes_Interests,\n\tinterests.value:\"address\".\"city\"::STRING(4000) AS Interest_City,\n\tinterests.value:\"address\".\"state\"::STRING(4000) AS Interest_State,\n\tinterests.value:\"address\".\"zip\"::STRING(4000) AS Interest_Zipcode,\n\tinterests.value:\"id\"::STRING(4000) AS Interest_Id,\n\tinterests.value:\"isPayer\"::STRING(4000) AS Interest_Is_Payer,\n    interests.value:\"loanNumber\"::STRING(4000) AS Interest_Loan_Number,\n\tinterests.value:\"name\"::STRING(4000) AS Interest_Name,\n\tinterests.value:\"name2\"::STRING(4000) AS Interest_Name2,\n\tinterests.value:\"name3\"::STRING(4000) AS Interest_Name3,\n\tinterests.value:\"type\"::STRING(4000) AS Interest_Type,\n\tinterests.value:\"version\"::STRING(4000) AS Interest_Version\nFROM\n\t\"NUCLEUS_ASSETS\" a,\n\tTABLE(FLATTEN(INPUT => a.$1:\"vehicle\":\"interests\")) interests;\nCREATE OR REPLACE VIEW v_String_Policies AS (\nSELECT\n    p.$1:\"expirationDate\"::STRING(4000) AS Expiration_Date,\n    p.$1:\"policyVersion\"::STRING(4000) AS Policy_Version,\n\tp.$1:\"changeEffectiveDate\"::STRING(4000) AS Change_Effective_Date,\n    p.$1:\"status\"::STRING(4000) AS Status,\n\tp.$1:\"riskState\"::STRING(4000) AS Risk_State,\n\tp.$1:\"policyNumber\"::STRING(4000) AS Policy_Number,\n  \tp.$1:\"transactionType\"::STRING(4000) AS Transaction_Type,\n\tp.$1:\"shortTerm\"::STRING(4000) AS Short_Term,\n\tp.$1:\"inceptionDate\"::STRING(4000) AS Inception_Date,\n\tp.$1:\"company\"::STRING(4000) AS Company,\n\tp.$1:\"id\"::STRING(4000) AS Policy_Id,\n\tp.$1:\"originalInceptionDate\"::STRING(4000) AS Original_Inception_Date,\n\tp.$1:\"formType\"::STRING(4000) AS Form_Type,\n    p.$1:\"line\"::STRING(4000) AS Line,\n\tp.$1:\"loyaltyScore\"::STRING(4000) AS Loyalty_Score,\n\tp.$1:\"producerName\"::STRING(4000) AS Producer_Name,\n\tp.$1:\"term\"::STRING(4000) AS Policy_Term,\n\tp.$1:\"source\"::STRING(4000) AS Source_System,\n    p.$1:\"subline\"::STRING(4000) AS Sub_Line,\n\tp.$1:\"policyType\"::STRING(4000) AS Policy_Type,\n\tp.$1:\"transactionRequestedBy\"::STRING(4000) AS Transaction_Requested_By,\n\tp.$1:\"createDate\"::STRING(4000) AS Create_Date,\n    p.$1:\"agencyNumber\"::STRING(4000) AS Agency_Number,\n\tp.$1:\"packageNumber\"::STRING(4000) AS Package_Number,\n\tp.$1:\"producerCode\"::STRING(4000) AS Producer_Code,\n    p.$1:\"ammendmentReason\"::STRING(4000) AS Ammendment_Reason,\n\tp.$1:\"effectiveDate\"::STRING(4000) AS Effective_Date,\n    p.$1:\"priorDocumentId\"::STRING(4000) AS Prior_Document_Id,\n\tp.$1:\"quoteNumber\"::STRING(4000) AS Quote_Number,\n    p.$1:\"transactionReason\"::STRING(4000) AS Transaction_Reason,\n    p.$2 AS Filename,\n    p.$3 AS File_Datetime\nFROM\n\t\"NUCLEUS_POLICIES\" p );\nCREATE OR REPLACE VIEW v_String_Policy_Addresses AS\nSELECT\n    p.\"$1\":\"id\"::STRING(4000) AS Policy_Id,\n    p.\"$1\":\"policyVersion\"::STRING(4000) AS Policy_Version,\n    addresses.value:\"id\"::STRING(4000) AS Address_Id,\n\taddresses.value:\"address\"::STRING(4000) AS Address,\n\taddresses.value:\"city\"::STRING(4000) AS City,\n\taddresses.value:\"state\"::STRING(4000) AS State,\n\taddresses.value:\"zip\"::STRING(4000) AS Zip,\n\taddresses.value:\"latitude\"::STRING(4000) AS Latitude,\n\taddresses.value:\"longitude\"::STRING(4000) AS Longitude,\n\taddresses.value:\"county\"::STRING(4000) AS County,\n    addresses.value:\"territory\"::STRING(4000) AS Territory,\n\taddresses.value:\"fips\"::STRING(4000) AS FIPS,\n    addresses.value:\"attributes\":\"garageLocation\"::STRING(4000) AS Garage_Location,\n\taddresses.value:\"attributes\":\"physical\"::STRING(4000) AS Physical_Address,\n\taddresses.value:\"attributes\":\"primary\"::STRING(4000) AS Primary_Address,\n\taddresses.value:\"attributes\":\"prior\"::STRING(4000) AS Prior_Address,\n\taddresses.value:\"attributes\":\"mailing\"::STRING(4000) AS Mailing_Address\nFROM\n\t\"NUCLEUS_POLICIES\" p,\n\tTABLE(flatten(INPUT => p.$1:\"addresses\")) addresses;\nCREATE OR REPLACE VIEW v_String_Policy_Billing AS\nSELECT\n\tp.\"$1\":\"id\"::STRING(4000) AS Policy_Id,\n    p.\"$1\":\"policyVersion\"::STRING(4000) AS Policy_Version,\n\tp.\"$1\":\"billing\":\"accountNumber\"::STRING(4000) AS Account_Number,\n\tp.\"$1\":\"billing\":\"accountingDate\"::STRING(4000) AS Accounting_Date,\n\tp.\"$1\":\"billing\":\"commission\"::STRING(4000) AS Commission,\n\tp.\"$1\":\"billing\":\"commissionChange\"::STRING(4000) AS Commission_Change,\n    p.\"$1\":\"billing\":\"commissionRate\"::STRING(4000) AS Commission_Rate,\n\tp.\"$1\":\"billing\":\"earnedPremium\"::STRING(4000) AS Earned_Premium,\n\tp.\"$1\":\"billing\":\"paymentPlan\"::STRING(4000) AS Payment_Plan,\n    p.\"$1\":\"billing\":\"termPremium\"::STRING(4000) AS Term_Premium,\n    p.\"$1\":\"billing\":\"termPremiumChange\"::STRING(4000) AS Term_Premium_Change,\n    p.\"$1\":\"billing\":\"totalCommission\"::STRING(4000) AS Total_Commission,\n\tp.\"$1\":\"billing\":\"totalPremium\"::STRING(4000) AS Total_Premium,\n\tp.\"$1\":\"billing\":\"totalPremiumChange\"::STRING(4000) AS Total_Premium_Change,\n\tp.\"$1\":\"billing\":\"writtenPremium\"::STRING(4000) AS Written_Premium,\n\tp.\"$1\":\"billing\":\"writtenPremiumChange\"::STRING(4000) AS Written_Premium_Change\nFROM\n\tNUCLEUS_POLICIES p;\nCREATE OR REPLACE VIEW v_String_Policy_Coverages AS\nSELECT\n\tp.$1:\"id\"::STRING(4000) AS Policy_Id,\n    p.$1:\"policyVersion\"::STRING(4000) AS Policy_Version,\n\tpolicy_coverages.value:\"id\"::STRING(4000) AS Coverage_Id,\n    policy_coverages.value:\"parentID\"::STRING(4000) AS Driver_Id_Parent_Id,\n\tpolicy_coverages.value:\"code\"::STRING(4000) AS Quote_Coverage_Code,\n    policy_coverages.value:\"covCode\"::STRING(4000) AS Insurance_Coverage_Code,\n    policy_coverages.value:\"accountingDate\"::STRING(4000) AS Accounting_Date,\n    policy_coverages.value:\"coverageDescription\"::STRING(4000) AS Quote_Coverage_Description,\n\tpolicy_coverages.value:\"commission\"::STRING(4000) AS Commission_Amount,\n\tpolicy_coverages.value:\"commissionChange\"::STRING(4000) AS Commission_Amount_Change,\n\tpolicy_coverages.value:\"driverID\"::STRING(4000) AS Driver_Id,\n\tpolicy_coverages.value:\"earnedPremium\"::STRING(4000) AS Earned_Premium,\n\tpolicy_coverages.value:\"formNumber\"::STRING(4000) AS Form_Number,\n\tpolicy_coverages.value:\"rate\"::STRING(4000) AS Rate,\n\tpolicy_coverages.value:\"rateChange\"::STRING(4000) AS Rate_Change,\n\tpolicy_coverages.value:\"termPremium\"::STRING(4000) AS Term_Premium_Amount,\n\tpolicy_coverages.value:\"termPremiumChange\"::STRING(4000) AS Term_Premium_Amount_Change,\n\tpolicy_coverages.value:\"value\"::STRING(4000) AS Value,\n    policy_coverages.value:\"valueType\"::STRING(4000) AS Value_Type,\n\tpolicy_coverages.value:\"writtenPremium\"::STRING(4000) AS Written_Premium,\n\tpolicy_coverages.value:\"writtenPremiumChange\"::STRING(4000) AS Written_Premium_Change\nFROM\n\tNUCLEUS_POLICIES p,\n\tTABLE(flatten(INPUT => p.$1:\"coverages\")) policy_coverages;\nCREATE OR REPLACE VIEW v_String_Policy_Forms AS \nSELECT\n    p.$1:\"id\"::STRING(4000) AS Policy_Id,\n    p.$1:\"policyVersion\"::STRING(4000) AS Policy_Version,\n    forms.value:\"activityAddedFromReport\"::STRING(4000) AS Activity_Added_From_Report,\n    forms.value:\"company\"::STRING(4000) AS Company,\n    forms.value:\"contractType\"::STRING(4000) AS Contract_Type,\n    forms.value:\"coverageCode\"::STRING(4000) AS Coverage_Code,\n    forms.value:\"editionDate\"::STRING(4000) AS Edition_Date,\n    forms.value:\"formEffectiveDate\"::STRING(4000) AS Form_Effective_Date,\n    forms.value:\"formName\"::STRING(4000) AS Form_Name,\n    forms.value:\"formNumber\"::STRING(4000) AS Form_Number,\n    forms.value:\"formType\"::STRING(4000) AS Form_Type,\n    forms.value:\"insScoreLessThan900\"::STRING(4000) AS INS_Score_Less_Than_900,    \n    forms.value:\"interestType\"::STRING(4000) AS Interest_Type,\n    forms.value:\"mustHaverForm\"::STRING(4000) AS Must_Have_Form,\n    forms.value:\"notes\"::STRING(4000) AS Notes,\n    forms.value:\"policyType\"::STRING(4000) AS Policy_Type,\n    forms.value:\"propertyClassCode\"::STRING(4000) AS Property_Class_Code,\n    forms.value:\"protectionDevice\"::STRING(4000) AS Protection_Device,    \n    forms.value:\"recordType\"::STRING(4000) AS Record_Type,\n    forms.value:\"riskState\"::STRING(4000) AS Risk_State,\n    forms.value:\"shortTerm\"::STRING(4000) AS Short_Term,\n    forms.value:\"sortOrder\"::STRING(4000) AS Unit_Number,\n    forms.value:\"transactionType\"::STRING(4000) AS Transaction_Type,\n    forms.value:\"variableDataFormFlag\"::STRING(4000) AS Variable_Form_Flag,\n    forms.value:\"vehicleType\"::STRING(4000) AS Vehicle_Type    \nFROM\n\t\"NUCLEUS_POLICIES\" p,\n\tTABLE(FLATTEN(INPUT => p.$1:\"forms\")) forms;\nCREATE OR REPLACE VIEW v_String_Policy_Forms_Asset_References AS \nSELECT\n\tp.$1:\"id\"::STRING(4000) AS Policy_Id,\n    arefs.value::STRING(4000) AS Reference_Asset_Id\nFROM\n\t\"NUCLEUS_POLICIES\" p,\n\tTABLE(FLATTEN(INPUT => p.$1:\"forms\")) forms,\n    TABLE(FLATTEN(INPUT => forms.value:\"assetReferenceIds\")) arefs;\nCREATE OR REPLACE VIEW v_String_Policy_Forms_Policy_References AS \nSELECT\n\tp.$1:\"id\"::STRING(4000) AS Policy_Id,\n    prefs.value::STRING(4000) AS Reference_Policy_Id\nFROM\n\t\"NUCLEUS_POLICIES\" p,\n\tTABLE(FLATTEN(INPUT => p.$1:\"forms\")) forms,\n    TABLE(FLATTEN(INPUT => forms.value:\"policyReferenceIds\")) prefs;\nCREATE OR REPLACE VIEW v_String_Policy_Incidents AS \nSELECT\n\tp.$1:\"id\"::STRING(4000) AS Policy_Id,\n    p.$1:\"policyVersion\"::STRING(4000) AS Policy_Version,\n    incidents.value:\"atFault\"::STRING(4000) AS At_Fault,\n    incidents.value:\"claimNumber\"::STRING(40000) AS Claim_Number,\n\tincidents.value:\"code\"::STRING(4000) AS Incident_Code,\n    incidents.value:\"convictionDate\"::STRING(4000) AS Conviction_Date,\n    incidents.value:\"description\"::STRING(4000) AS Description,\n    incidents.value:\"id\"::STRING(4000) AS Incident_Id,\n    incidents.value:\"person\"::STRING(4000) AS Person,\n    incidents.value:\"source\"::STRING(4000) AS Source,\n    incidents.value:\"svcCode\"::STRING(4000) AS Service_Code,\n    incidents.value:\"svcCodeFull\"::STRING(4000) AS Incident_Code_Full,\n    incidents.value:\"totalClaimAmount\"::STRING(4000) AS Total_Claim_Amount,\n    incidents.value:\"type\"::STRING(4000) AS Incident_Type,\n    incidents.value:\"violationPoints\"::STRING(4000) AS Violation_Points\nFROM\n\t\"NUCLEUS_POLICIES\" p,\n\tTABLE(FLATTEN(INPUT => p.$1:\"incidents\")) incidents;\n    CREATE OR REPLACE VIEW v_String_Policy_Interests AS\nSELECT\n\tp.$1:\"id\"::STRING(4000) AS Policy_Id,\n\tinterests.value:\"address\".\"address\"::STRING(4000) AS Interests_Address,\n\tinterests.value:\"address\".\"attributes\".\"interest\"::STRING(4000) AS Interests_Attributes_Interests,\n\tinterests.value:\"address\".\"city\"::STRING(4000) AS Interest_City,\n\tinterests.value:\"address\".\"state\"::STRING(4000) AS Interest_State,\n\tinterests.value:\"address\".\"zip\"::STRING(4000) AS Interest_Zipcode,\n\tinterests.value:\"id\"::STRING(4000) AS Interest_Id,\n\tinterests.value:\"isPayer\"::STRING(4000) AS Interest_Is_Payer,\n    interests.value:\"loanNumber\"::STRING(4000) AS Interest_Loan_Number,\n\tinterests.value:\"name\"::STRING(4000) AS Interest_Name,\n\tinterests.value:\"name2\"::STRING(4000) AS Interest_Name2,\n\tinterests.value:\"name3\"::STRING(4000) AS Interest_Name3,\n\tinterests.value:\"type\"::STRING(4000) AS Interest_Type,\n\tinterests.value:\"version\"::STRING(4000) AS Interest_Version\nFROM\n\t\"NUCLEUS_POLICIES\" p,\n\tTABLE(FLATTEN(INPUT => p.$1:\"property\":\"interests\")) interests;\nCREATE OR REPLACE VIEW v_String_Policy_Losses AS\nSELECT\n\tp.$1:\"id\"::STRING(4000) AS Policy_Id,\n    p.$1:\"policyVersion\"::STRING(4000) AS Policy_Version,\n    losses.value:\"policyId\"::STRING(4000) AS Loss_Policy_Id,\n\tlosses.value:\"id\"::STRING(4000) AS Loss_Id,\n    losses.value:\"amount\"::STRING(4000) AS Loss_Amount,\n\tlosses.value:\"category\"::STRING(4000) AS Category,\n\tlosses.value:\"chargeable\"::STRING(4000) AS Chargeable,\n\tlosses.value:\"description\"::STRING(4000) AS Description,\n\tlosses.value:\"display\"::STRING(4000) AS Display,\n\tlosses.value:\"lossDate\"::STRING(4000) AS Loss_Date,\n\tlosses.value:\"lossDescription\"::STRING(4000) AS Loss_Description,\n\tlosses.value:\"propertyId\"::STRING(4000) AS Property_Id,\n\tlosses.value:\"riskClaim\"::STRING(4000) AS Risk_Claim,\n\tlosses.value:\"source\"::STRING(4000) AS Loss_Source,\n\tlosses.value:\"version\"::STRING(4000) AS Version,\n    losses.value:\"waitFor\"::STRING(4000) AS Wait_For\nFROM\n\t\"NUCLEUS_POLICIES\" p,\n\tTABLE(FLATTEN(INPUT => p.$1:\"losses\")) losses;\nCREATE OR REPLACE VIEW v_String_Policy_NA_Coverages AS\nSELECT\n\tp.$1:\"id\"::STRING(4000) AS Policy_Id,\n    p.$1:\"policyVersion\"::STRING(4000) AS Policy_Version,\n\tnacoverages.value:\"id\"::STRING(4000) AS Coverage_Id,\n\tnacoverages.value:\"code\"::STRING(4000) AS NA_Code,\n    nacoverages.value:\"covCode\"::STRING(4000) AS Coverage_Code,\n    nacoverages.value:\"coverageDescription\"::STRING(4000) AS Coverage_Description,\n\tnacoverages.value:\"isLimit\"::STRING(4000) AS Is_Limit,\n\tnacoverages.value:\"rate\"::STRING(4000) AS Coverage_Amount,\n\tnacoverages.value:\"termPremium\"::STRING(4000) AS Term_Premium,\n\tnacoverages.value:\"value\"::STRING(4000) AS Coverage_Value,\n    nacoverages.value:\"valueType\"::STRING(4000) AS Coverage_Value_Type,\n\tnacoverages.value:\"version\"::STRING(4000) AS Version\nFROM\n\t\"NUCLEUS_POLICIES\" p,\n\tTABLE(flatten(INPUT => p.$1:\"notApplicableCoverages\")) nacoverages;\nCREATE OR REPLACE VIEW v_String_Policy_People AS\nSELECT\n\tp.$1:\"id\"::STRING(4000) AS Policy_Id,\n    p.$1:\"policyVersion\"::STRING(4000) AS Policy_Version,\n    people.value:\"id\"::STRING(4000) AS People_Id,\n    people.value:\"attributes\":\"driver\"::STRING(4000) AS Driver,\n    people.value:\"attributes\":\"driverId\"::STRING(4000) AS Driver_Id,\n    people.value:\"attributes\":\"extendedNonOwned\"::STRING(4000) AS Extended_NonOwned,\n    people.value:\"attributes\":\"policyHolder\"::STRING(4000) AS Policy_Holder,\n    people.value:\"attributes\":\"primary\"::STRING(4000) AS Primary,\n    people.value:\"attributes\":\"rated\"::STRING(4000) AS Rated,\n    people.value:\"driverInfo\":\"driverInceptionDate\"::STRING(4000) AS Driver_Inception_Date,\n    people.value:\"driverInfo\":\"driversLicenseLicenseDate\"::STRING(4000) AS Driver_License_Date,\n    people.value:\"driverInfo\":\"driversLicenseNumber\"::STRING(4000) AS Driver_License_Number,\n    people.value:\"driverInfo\":\"driversLicenseState\"::STRING(4000) AS Driver_License_State,\n    people.value:\"driverInfo\":\"driversLicenseStatus\"::STRING(4000) AS Driver_License_Status,\n    people.value:\"driverInfo\":\"extendedNonOwnedAccountingDate\"::STRING(4000) AS Driver_Extended_NonOwned_Accounting_Date,\n    people.value:\"driverInfo\":\"extendedNonOwnedCommission\"::STRING(4000) AS Driver_Extended_NonOwned_Commission_Amount,\n    people.value:\"driverInfo\":\"extendedNonOwnedCommissionChange\"::STRING(4000) AS Driver_Extended_NonOwned_Commission_Amount_Change,\n    people.value:\"driverInfo\":\"extendedNonOwnedEarnedPremium\"::STRING(4000) AS Driver_Extended_NonOwned_Earned_Premium,\n    people.value:\"driverInfo\":\"extendedNonOwnedEarnedPremiumChange\"::STRING(4000) AS Driver_Extended_NonOwned_EarnedPremium_Change,\n    people.value:\"driverInfo\":\"extendedNonOwnedTotal\"::STRING(4000) AS Driver_Extended_NonOwned_Total,\n    people.value:\"driverInfo\":\"extendedNonOwnedTotalChange\"::STRING(4000) AS Driver_Extended_NonOwned_Total_Change,\n    people.value:\"driverInfo\":\"extendedNonOwnedWrittenPremium\"::STRING(4000) AS Driver_Extended_NonOwned_Written_Premium,\n    people.value:\"driverInfo\":\"extendedNonOwnedWrittenPremiumChange\"::STRING(4000) AS Driver_Extended_NonOwned_Written_Premium_Change,\n    people.value:\"effectiveDate\"::STRING(4000) AS Effecitve_Date,\n    people.value:\"employmentInfo\":\"employer\"::STRING(4000) AS Employment_Employer,\n    people.value:\"employmentInfo\":\"employerYears\"::STRING(4000) AS Employment_Years_Employed,\n    people.value:\"employmentInfo\":\"employmentStatus\"::STRING(4000) AS Employment_Status,\n    people.value:\"employmentInfo\":\"occupation\"::STRING(4000) AS Employment_Occupation,\n    people.value:\"inceptionDate\"::STRING(4000) AS Inception_Date,\n    people.value:\"info\":\"dateOfBirth\"::STRING(4000) AS Date_Of_Birth,\n    people.value:\"info\":\"firstName\"::STRING(4000) AS First_Name,\n    people.value:\"info\":\"gender\"::STRING(4000) AS Gender,\n    people.value:\"info\":\"insuranceScore\":\"date\"::STRING(4000) AS Ins_Score_Date,\n    people.value:\"info\":\"insuranceScore\":\"reasonCode1\"::STRING(4000) AS Ins_Score_Reason_Code1,\n    people.value:\"info\":\"insuranceScore\":\"refNumber\"::STRING(4000) AS Ins_Score_Reference_Number,\n    people.value:\"info\":\"insuranceScore\":\"score\"::STRING(4000) AS Ins_Score_Number,\n    people.value:\"info\":\"insuranceScore\":\"status\"::STRING(4000) AS Ins_Score_Status,\n    people.value:\"info\":\"lastName\"::STRING(4000) AS Last_Name,\n    people.value:\"info\":\"maritalStatus\"::STRING(4000) AS Marital_Status,\n    people.value:\"info\":\"middleInitial\"::STRING(4000) AS Middle_Initial,\n    people.value:\"info\":\"newAddress\"::STRING(4000) AS New_Address,\n    people.value:\"info\":\"priorCarrier\":\"expirationDate\"::STRING(4000) AS Prior_Carrier_Expiration_Date,\n    people.value:\"info\":\"priorCarrier\":\"isRewrite\"::STRING(4000) AS Prior_Carrier_Is_Rewrite,\n    people.value:\"info\":\"priorCarrier\":\"lengthInsured\"::STRING(4000) AS Prior_Carrier_Length_Insured,\n    people.value:\"info\":\"priorCarrier\":\"liabilityLimit\"::STRING(4000) AS Prior_Carrier_Liability_Limit,\n    people.value:\"info\":\"priorCarrier\":\"liabilityType\"::STRING(4000) AS Prior_Carrier_Liability_Type,\n    people.value:\"info\":\"priorCarrier\":\"name\"::STRING(4000) AS Prior_Carrier_Name,\n    people.value:\"info\":\"priorCarrier\":\"newAddress\"::STRING(4000) AS Prior_New_Address,\n    people.value:\"info\":\"priorCarrier\":\"noInsuranceReason\"::STRING(4000) AS Prior_Carrier_No_Insurance_Reason,\n    people.value:\"info\":\"priorCarrier\":\"policyNumber\"::STRING(4000) AS Prior_Carrier_Policy_Number,\n    people.value:\"info\":\"priorCarrier\":\"priorPolicyType\"::STRING(4000) AS Prior_Carrier_Policy_Type,\n    people.value:\"info\":\"priorCarrier\":\"priorPolicyTypeName\"::STRING(4000) AS Prior_Carrier_Policy_Type_Name,\n    people.value:\"info\":\"priorCarrier\":\"source\"::STRING(4000) AS Prior_Carrier_Source,\n    people.value:\"info\":\"relationshipToApplicant\"::STRING(4000) AS Relationship_To_Applicant,\n    people.value:\"sortOrder\"::STRING(4000) AS Unit\nFROM\n\t\"NUCLEUS_POLICIES\" p,\n\tTABLE(flatten(INPUT => p.$1:\"people\")) people;\nCREATE OR REPLACE VIEW v_String_Policy_People_Contact_Method AS\nSELECT\n      p.$1:\"id\"::STRING(4000) AS Policy_ID,\n      p.$1:\"policyVersion\"::STRING(4000) AS Policy_Version,\n      people.value:\"id\"::STRING(4000) AS People_Id,\n      contact_methods.value:\"type\"::STRING(4000) AS Contact_Method_Type,\n      contact_methods.value:\"value\"::STRING(4000) AS Contact_Method_Value\nFROM\n\t\"NUCLEUS_POLICIES\" p,\n\tTABLE(FLATTEN(INPUT => p.$1, path => 'people')) people,\n    TABLE(FLATTEN(INPUT => people.value:\"contactMethods\")) contact_methods;\nCREATE OR REPLACE VIEW v_String_Policy_People_Discount_Questions AS\nSELECT\n      p.$1:\"id\"::STRING(4000) AS Policy_ID,\n      p.$1:\"policyVersion\"::STRING(4000) AS Policy_Version,\n      people.value:\"id\"::STRING(4000) AS People_Id,\n      discount_questions.value:\"dateAssociated\"::STRING(4000) AS Questions_Date_Associated,\n      discount_questions.value:\"id\"::STRING(4000) AS Questions_Id,\n      discount_questions.value:\"name\"::STRING(4000) AS Questions_Name,\n      discount_questions.value:\"value\"::STRING(4000) AS Questions_Value\nFROM\n\t\"NUCLEUS_POLICIES\" p,\n\tTABLE(FLATTEN(INPUT => p.$1, path => 'people')) people,\n    TABLE(FLATTEN(INPUT => people.value:\"info\":\"discountQuestions\")) discount_questions;\nCREATE OR REPLACE VIEW v_String_Policy_People_Incidents AS\nSELECT\n\tp.$1:\"id\"::STRING(4000) AS Policy_Id,\n    p.$1:\"policyVersion\"::STRING(4000) AS Policy_Version,\n    people.value:\"id\"::STRING(4000) AS People_Id,\n    incidents.value:\"atFault\"::STRING(4000) AS At_Fault,\n    incidents.value:\"claimNumber\"::STRING(4000) AS Claim_Number,\n    incidents.value:\"code\"::STRING(4000) AS Incident_Code,\n    incidents.value:\"convictionDate\"::STRING(4000) AS Conviction_Date,\n    incidents.value:\"description\"::STRING(4000) AS Description,\n    incidents.value:\"id\"::STRING(4000) AS Incident_Id,\n    incidents.value:\"incidentDate\"::STRING(4000) AS Incident_Date,\n    incidents.value:\"person\"::STRING(4000) AS Person,\n    incidents.value:\"source\"::STRING(4000) AS Source,\n    incidents.value:\"svcCode\"::STRING(4000) AS Service_Code,\n    incidents.value:\"svcCodeFull\"::STRING(4000) AS Service_Code_Full,\n    incidents.value:\"totalClaimAmount\"::STRING(4000) AS Total_Claim_Amount,\n    incidents.value:\"type\"::STRING(4000) AS Incident_Type,\n    incidents.value:\"violationPoints\"::STRING(4000) AS Violation_Points    \nFROM\n\t\"NUCLEUS_POLICIES\" p,\n\tTABLE(flatten(INPUT => p.$1:\"people\")) people,\n    TABLE(flatten(INPUT => p.$1:\"people\":\"incidents\")) incidents;\nCREATE OR REPLACE VIEW v_String_Policy_PersonalLines_Companion_Policies AS \nSELECT\n\tp.$1:\"id\"::STRING(4000) AS Policy_Id,\n    p.$1:\"policyVersion\"::STRING(4000) AS Policy_Version,\n\tcompanionpolicies.value:\"policyNumber\"::STRING(4000) AS CompanionPolicy_Policy_Number,\n    companionpolicies.value:\"policyType\"::STRING(4000) AS CompanionPolicy_Policy_Type\nFROM\n\t\"NUCLEUS_POLICIES\" p,\n\tTABLE(FLATTEN(INPUT => p.$1:\"personalLines\":\"companionPolicies\")) companionpolicies;\nCREATE OR REPLACE VIEW v_String_Policy_PersonalLines_Discount_Questions AS \nSELECT\n\tp.$1:\"id\"::STRING(4000) AS Policy_Id,\n    p.$1:\"policyVersion\"::STRING(4000) AS Policy_Version,\n\tdiscountquestions.value:\"additionalInfo\"::STRING(4000) AS Discount_Questions_Additional_Info,\n    discountquestions.value:\"id\"::STRING(4000) AS Discount_Questions_Id,\n    discountquestions.value:\"name\"::STRING(4000) AS Discount_Questions_Name,\n    discountquestions.value:\"value\"::STRING(4000) AS Discount_Questions_Value\nFROM\n\t\"NUCLEUS_POLICIES\" p,\n\tTABLE(FLATTEN(INPUT => p.$1:\"personalLines\":\"discountQuestions\")) discountquestions;\nCREATE OR REPLACE VIEW v_String_Policy_PersonalLines_Questions AS \nSELECT\n    p.$1:\"id\"::STRING(4000) AS Policy_Id,\n    p.$1:\"policyVersion\"::STRING(4000) AS Policy_Version,\n    questions.value:\"answer\"::STRING(4000) AS Questions_Answer,\n    questions.value:\"comments\"::STRING(4000) AS Questions_Comments,\n    questions.value:\"id\"::STRING(4000) AS Questions_Id,\n    questions.value:\"questionIndex\"::STRING(4000) AS Questions_Index,\n    questions.value:\"version\"::STRING(4000) AS Questions_Version\nFROM\n\t\"NUCLEUS_POLICIES\" p,\n\tTABLE(FLATTEN(INPUT => p.$1:\"personalLines\":\"questions\")) questions;\\n\\n\"\"\"\n\ncontext.updateVariable('vScript', vScript)\nprint vScript"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"69154":{"id":69154,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-288,"y":-256,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[69156],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"69155":{"id":69155,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-192,"y":-224,"width":32,"height":32,"inputConnectorIDs":[69156],"outputSuccessConnectorIDs":[69157],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get Table/View Content"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\nimport boto3\nimport json\n\n#Parse the S3_Config_Path variable for the various path parts needed\nbucket = S3_Config_FilePath.replace(\"s3://\", \"\") #strip off the s3://\n\nfolder_path = bucket[bucket.index(\"/\")+1:bucket.rfind(\"/\") + 1] #Get folder_path\n\nbucket = bucket[0:bucket.index('/')] #trim up just the bucket \n\n#Instantiate S3 client\ns3 = boto3.client('s3')\n\n#Get config and template files from S3\nvw_file = s3.get_object(Bucket=bucket, Key=folder_path + 'Template_Extract_Views.txt')\n\n#Get content from config and template files\ncontext.updateVariable('vView_Temp', vw_file[\"Body\"].read().decode())"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"69157":{"id":69157,"sourceID":69155,"targetID":69152}},"failureConnectors":{},"unconditionalConnectors":{"69156":{"id":69156,"sourceID":69154,"targetID":69155}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{"vDatabase":{"definition":{"name":"vDatabase","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"vRole":{"definition":{"name":"vRole","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"vScript":{"definition":{"name":"vScript","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"vView_Temp":{"definition":{"name":"vView_Temp","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":""},"vWarehouse":{"definition":{"name":"vWarehouse","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""}},"grids":{}},"info":{"name":"Base_Create_Views_Script","description":"","type":"ORCHESTRATION","tag":"c8c6b50a-e53c-4bdd-8afc-fe2bb78f1422"}}