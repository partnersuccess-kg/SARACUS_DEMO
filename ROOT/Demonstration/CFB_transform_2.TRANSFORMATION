{"job":{"components":{"68694":{"id":68694,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":880,"y":80,"width":32,"height":32,"inputConnectorIDs":[68742],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"cfb_upset"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"cfb_upset"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"formattedSpread"},"2":{"slot":2,"type":"STRING","value":"formattedSpread"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"actualWinner"},"2":{"slot":2,"type":"STRING","value":"actualWinner"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"projectedWinner"},"2":{"slot":2,"type":"STRING","value":"projectedWinner"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"result"},"2":{"slot":2,"type":"STRING","value":"result"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"season"},"2":{"slot":2,"type":"STRING","value":"season"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"awayTeam"},"2":{"slot":2,"type":"STRING","value":"awayTeam"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"awayScore"},"2":{"slot":2,"type":"STRING","value":"awayScore"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"awayTeamQB"},"2":{"slot":2,"type":"STRING","value":"awayTeamQB"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"homeTeam"},"2":{"slot":2,"type":"STRING","value":"homeTeam"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"homeScore"},"2":{"slot":2,"type":"STRING","value":"homeScore"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"homeTeamQB"},"2":{"slot":2,"type":"STRING","value":"homeTeamQB"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"pointDifferential"},"2":{"slot":2,"type":"STRING","value":"pointDifferential"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"204":{"slot":204,"name":"Order By","elements":{},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"68696":{"id":68696,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":352,"y":80,"width":32,"height":32,"inputConnectorIDs":[68741],"outputConnectorIDs":[68740],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter \"First\" Duplicate"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"rn"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"68697":{"id":68697,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-629958239,"x":704,"y":80,"width":32,"height":32,"inputConnectorIDs":[68739,68743],"outputConnectorIDs":[68742],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Join & Include Teams' QB"}}}},"visible":true},"2":{"slot":2,"name":"Main Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Upset Amount"}}}},"visible":true},"3":{"slot":3,"name":"Main Table Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"games"}}}},"visible":true},"4":{"slot":4,"name":"Joins","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"cfb_stats_flat"},"2":{"slot":2,"type":"STRING","value":"away_stats"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"cfb_stats_flat"},"2":{"slot":2,"type":"STRING","value":"home_stats"},"3":{"slot":3,"type":"STRING","value":"Left"}}}},"visible":true},"5":{"slot":5,"name":"Join Expressions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"games\".\"awayTeam\" = \"away_stats\".\"team\"\nAND \"away_stats\".\"statType\" = 'YDS' \nAND \"away_stats\".\"category\" = 'passing'\nAND \"away_stats\".\"stat\" = (select max(\"stat\") from \"DEV_DB\".\"KAREY\".\"cfb_stats_flat\" AS \"s\" where \n\t\t\t\t\t\"s\".\"team\" = \"away_stats\".\"team\" AND \"s\".\"statType\" = 'YDS' AND \"s\".\"category\" = 'passing')"},"2":{"slot":2,"type":"STRING","value":"games_Left_away_stats"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"\"games\".\"homeTeam\" = \"home_stats\".\"team\"\nAND \"home_stats\".\"statType\" = 'YDS' \nAND \"home_stats\".\"category\" = 'passing'\nAND \"home_stats\".\"stat\" = (select max(\"stat\") from \"DEV_DB\".\"KAREY\".\"cfb_stats_flat\" AS \"s\" where \n\t\t\t\t\t\"s\".\"team\" = \"home_stats\".\"team\" AND \"s\".\"statType\" = 'YDS' AND \"s\".\"category\" = 'passing')"},"2":{"slot":2,"type":"STRING","value":"games_Left_home_stats"}}}},"visible":true},"6":{"slot":6,"name":"Output Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"games.actualWinner"},"2":{"slot":2,"type":"STRING","value":"actualWinner"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"games.projectedWinner"},"2":{"slot":2,"type":"STRING","value":"projectedWinner"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"games.pointDifferential"},"2":{"slot":2,"type":"STRING","value":"pointDifferential"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"games.season"},"2":{"slot":2,"type":"STRING","value":"season"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"games.result"},"2":{"slot":2,"type":"STRING","value":"result"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"games.awayTeam"},"2":{"slot":2,"type":"STRING","value":"awayTeam"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"games.awayScore"},"2":{"slot":2,"type":"STRING","value":"awayScore"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"away_stats.player"},"2":{"slot":2,"type":"STRING","value":"awayTeamQB"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"games.homeTeam"},"2":{"slot":2,"type":"STRING","value":"homeTeam"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"games.homeScore"},"2":{"slot":2,"type":"STRING","value":"homeScore"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"home_stats.player"},"2":{"slot":2,"type":"STRING","value":"homeTeamQB"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"games.formattedSpread"},"2":{"slot":2,"type":"STRING","value":"formattedSpread"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"68698":{"id":68698,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":704,"y":-32,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[68739],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"cfb_stats_flat"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"cfb_stats_flat"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"category"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"stat"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"statType"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"team"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"player"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"68699":{"id":68699,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":2139809017,"x":352,"y":-32,"width":32,"height":32,"inputConnectorIDs":[68745],"outputConnectorIDs":[68741],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Set Duplicate Row Count"}}}},"visible":true},"2":{"slot":2,"name":"Include input columns.","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Partition Data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"awayTeam"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"homeTeam"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"season"}}}},"visible":true},"4":{"slot":4,"name":"Ordering within partitions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"awayTeam"},"2":{"slot":2,"type":"STRING","value":"Asc"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"homeTeam"},"2":{"slot":2,"type":"STRING","value":"Asc"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"season"},"2":{"slot":2,"type":"STRING","value":"Asc"}}}},"visible":true},"5":{"slot":5,"name":"Functions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Row Number"},"2":{"slot":2,"type":"STRING","value":"rn"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"68700":{"id":68700,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":176,"y":80,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[68745],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Lateral Flatten Betting Odds"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT \n\"i\".\"Data Value\":\"awayScore\"::NUMBER AS \"awayScore\",\n\"i\".\"Data Value\":\"awayTeam\"::VARCHAR AS \"awayTeam\",\n\"i\".\"Data Value\":\"homeScore\"::NUMBER AS \"homeScore\",\n\"i\".\"Data Value\":\"homeTeam\"::VARCHAR AS \"homeTeam\",\n\"i\".\"Data Value\":\"season\"::NUMBER AS \"season\",\n\"n\".value:\"formattedSpread\"::VARCHAR as \"formattedSpread\",\n\"n\".value:\"overUnder\"::VARCHAR as \"overUnder\",\n\"n\".value:\"provider\"::VARCHAR as \"provider\",\n\"n\".value:\"spread\"::VARCHAR as \"spread\"\nFROM \n\"DEV_DB\".\"KAREY\".\"BettingLines_comprehensive\" \"i\",\nlateral flatten( input => \"i\".\"Data Value\":\"lines\") \"n\""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"68736":{"id":68736,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":528,"y":-32,"width":32,"height":32,"inputConnectorIDs":[68740],"outputConnectorIDs":[68738],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Projected & Actual Winner"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"regexp_replace(\"formattedSpread\",'-.*','')"},"2":{"slot":2,"type":"STRING","value":"projectedWinner"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(LTRIM(\"spread\",'- '),0)"},"2":{"slot":2,"type":"STRING","value":"spread"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN \"homeScore\" < \"awayScore\" THEN \"awayTeam\" ELSE \"homeTeam\" END"},"2":{"slot":2,"type":"STRING","value":"actualWinner"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ABS(\"awayScore\"-\"homeScore\")"},"2":{"slot":2,"type":"STRING","value":"scoreDifference"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"68737":{"id":68737,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":528,"y":80,"width":32,"height":32,"inputConnectorIDs":[68738],"outputConnectorIDs":[68743],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Upset Amount"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN trim(\"projectedWinner\",' ') <> trim(\"actualWinner\",' ') THEN (\"spread\"+\"scoreDifference\") \nWHEN trim(\"projectedWinner\",' ') = trim(\"actualWinner\",' ') THEN ABS(\"scoreDifference\"-\"spread\") \nELSE 0 END "},"2":{"slot":2,"type":"STRING","value":"pointDifferential"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN trim(\"projectedWinner\",' ') <> trim(\"actualWinner\",' ') THEN 'upset' \nELSE 'expected winner won' END"},"2":{"slot":2,"type":"STRING","value":"result"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"68738":{"id":68738,"sourceID":68736,"targetID":68737},"68739":{"id":68739,"sourceID":68698,"targetID":68697},"68740":{"id":68740,"sourceID":68696,"targetID":68736},"68741":{"id":68741,"sourceID":68699,"targetID":68696},"68742":{"id":68742,"sourceID":68697,"targetID":68694},"68743":{"id":68743,"sourceID":68737,"targetID":68697},"68745":{"id":68745,"sourceID":68700,"targetID":68699}},"notes":{"68695":{"id":68695,"x":46,"y":-70,"width":202,"height":111,"text":"**ALMOST AT THE FINISH LINE**\n\n- Flatten betting data to structured format\n- Determine size of upset, based on projected vs actual results\n- Enrich w quarterback data\n- Write to table in Snowflake\n","colour":"00ce4f"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"CFB_transform_2","description":"","type":"TRANSFORMATION","tag":"4bc751cd-0662-48a3-b77c-ecaece847365"}}