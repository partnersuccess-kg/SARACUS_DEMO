{"job":{"components":{"71724":{"id":71724,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1701703136,"x":1040,"y":320,"width":32,"height":32,"inputConnectorIDs":[71737],"outputConnectorIDs":[71743],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Aggregate 0"}}}},"visible":true},"2":{"slot":2,"name":"Groupings","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flight_year"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"flight_month"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"destination"}}}},"visible":true},"3":{"slot":3,"name":"Aggregations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"delay_time"},"2":{"slot":2,"type":"STRING","value":"Average"}}}},"visible":true},"4":{"slot":4,"name":"Grouping Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Group By"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"71725":{"id":71725,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-629958239,"x":608,"y":176,"width":32,"height":32,"inputConnectorIDs":[71739,71740],"outputConnectorIDs":[71734],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Join 0"}}}},"visible":true},"2":{"slot":2,"name":"Main Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rank Longest Airtime"}}}},"visible":true},"3":{"slot":3,"name":"Main Table Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"main"}}}},"visible":true},"4":{"slot":4,"name":"Joins","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"km_and_miles"},"2":{"slot":2,"type":"STRING","value":"convert"},"3":{"slot":3,"type":"STRING","value":"Left"}}}},"visible":true},"5":{"slot":5,"name":"Join Expressions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"main\".\"distance_type\"=\"convert\".\"source_type\""},"2":{"slot":2,"type":"STRING","value":"main_Left_convert"}}}},"visible":true},"6":{"slot":6,"name":"Output Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"main.crs_arrival_time"},"2":{"slot":2,"type":"STRING","value":"crs_arrival_time"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"main.arrival_time"},"2":{"slot":2,"type":"STRING","value":"arrival_time"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"main.taxi_in"},"2":{"slot":2,"type":"STRING","value":"taxi_in"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"main.distance"},"2":{"slot":2,"type":"STRING","value":"distance"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"main.flight_number"},"2":{"slot":2,"type":"STRING","value":"flight_number"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"main.origin"},"2":{"slot":2,"type":"STRING","value":"origin"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"main.destination"},"2":{"slot":2,"type":"STRING","value":"destination"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"main.airtime"},"2":{"slot":2,"type":"STRING","value":"airtime"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"main.carrier"},"2":{"slot":2,"type":"STRING","value":"carrier"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"main.taxi_out"},"2":{"slot":2,"type":"STRING","value":"taxi_out"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"main.flight_date"},"2":{"slot":2,"type":"STRING","value":"flight_date"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"main.crs_departure_time"},"2":{"slot":2,"type":"STRING","value":"crs_departure_time"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"main.distance_type"},"2":{"slot":2,"type":"STRING","value":"distance_type"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"main.actual_elapsed_time"},"2":{"slot":2,"type":"STRING","value":"actual_elapsed_time"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"main.departure_time"},"2":{"slot":2,"type":"STRING","value":"departure_time"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"main.Source Table"},"2":{"slot":2,"type":"STRING","value":"Source Table"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"main.longest_airtime_rank"},"2":{"slot":2,"type":"STRING","value":"longest_airtime_rank"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"convert.source_type"},"2":{"slot":2,"type":"STRING","value":"source_type"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"convert.target_type"},"2":{"slot":2,"type":"STRING","value":"target_type"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"convert.factor"},"2":{"slot":2,"type":"STRING","value":"factor"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"71726":{"id":71726,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1838652813,"x":896,"y":176,"width":32,"height":32,"inputConnectorIDs":[71738],"outputConnectorIDs":[71736,71745],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Convert Type"}}}},"visible":true},"2":{"slot":2,"name":"Conversions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flight_date"},"2":{"slot":2,"type":"STRING","value":"DATE"},"3":{"slot":3,"type":"INTEGER","value":""},"4":{"slot":4,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"71727":{"id":71727,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":335239555,"x":1040,"y":176,"width":32,"height":32,"inputConnectorIDs":[71736],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"fct_flightanalysis"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"fct_flightanalysis"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${env_dwh_schema_name}"}}}},"visible":true},"8":{"slot":8,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"71728":{"id":71728,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":1216,"y":320,"width":32,"height":32,"inputConnectorIDs":[71743],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"fct_flightanalysis_summary"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"fct_flightanalysis_summary"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flight_year"},"2":{"slot":2,"type":"STRING","value":"year"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"flight_month"},"2":{"slot":2,"type":"STRING","value":"month"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"destination"},"2":{"slot":2,"type":"STRING","value":"airportcode"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"avg_delay_time"},"2":{"slot":2,"type":"STRING","value":"averagedelaytime"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Truncate"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${env_dwh_schema_name}"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"71729":{"id":71729,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":-2009723820,"x":96,"y":176,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[71742],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"vew_flights_20%"}}}},"visible":true},"4":{"slot":4,"name":"Pattern Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Like"}}}},"visible":true},"5":{"slot":5,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Pattern","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"vew_flights_20%"}}}},"visible":true},"8":{"slot":8,"name":"Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"actual_elapsed_time"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"airtime"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"arrival_time"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"crs_arrival_time"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"departure_time"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"destination"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"flight_date"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"origin"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"taxi_in"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"crs_departure_time"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"distance"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"distance_type"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"taxi_out"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"carrier"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"flight_number"}}}},"visible":true},"9":{"slot":9,"name":"Cast Types","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"True"}}}},"visible":true},"10":{"slot":10,"name":"Add Source Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"True"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"71730":{"id":71730,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":736,"y":176,"width":32,"height":32,"inputConnectorIDs":[71734],"outputConnectorIDs":[71738],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calculate Distance Fields"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ROUND (case when \"distance_type\" = 'km' then \"distance\" else \"distance\" * \"factor\" end)"},"2":{"slot":2,"type":"STRING","value":"distance_km"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"ROUND (case when \"distance_type\" = 'miles' then \"distance\" else \"distance\" * \"factor\" end)"},"2":{"slot":2,"type":"STRING","value":"distance_miles"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"71731":{"id":71731,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":896,"y":320,"width":32,"height":32,"inputConnectorIDs":[71745],"outputConnectorIDs":[71737],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calculate Average Delay"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"crs_arrival_time\"-\"arrival_time\""},"2":{"slot":2,"type":"STRING","value":"delay_time"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"DATE_PART(year,\"flight_date\")"},"2":{"slot":2,"type":"STRING","value":"flight_year"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"DATE_PART(month,\"flight_date\")"},"2":{"slot":2,"type":"STRING","value":"flight_month"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"71732":{"id":71732,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":738944574,"x":432,"y":336,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[71740],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"km_and_miles"}}}},"visible":true},"2":{"slot":2,"name":"Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"source_type"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":""},"4":{"slot":4,"type":"INTEGER","value":""}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"target_type"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":""},"4":{"slot":4,"type":"INTEGER","value":""}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"factor"},"2":{"slot":2,"type":"STRING","value":"NUMBER"},"3":{"slot":3,"type":"INTEGER","value":"10"},"4":{"slot":4,"type":"INTEGER","value":"8"}}}},"visible":true},"3":{"slot":3,"name":"Values","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"miles"},"2":{"slot":2,"type":"STRING","value":"km"},"3":{"slot":3,"type":"DECIMAL","value":"1.60934"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"km"},"2":{"slot":2,"type":"STRING","value":"miles"},"3":{"slot":3,"type":"DECIMAL","value":"0.621371"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"71733":{"id":71733,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":2139809017,"x":448,"y":176,"width":32,"height":32,"inputConnectorIDs":[71741],"outputConnectorIDs":[71739],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rank Longest Airtime"}}}},"visible":true},"2":{"slot":2,"name":"Include input columns.","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Partition Data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"destination"}}}},"visible":true},"4":{"slot":4,"name":"Ordering within partitions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"actual_elapsed_time"},"2":{"slot":2,"type":"STRING","value":"Desc"}}}},"visible":true},"5":{"slot":5,"name":"Functions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Dense Rank"},"2":{"slot":2,"type":"STRING","value":"longest_airtime_rank"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"71735":{"id":71735,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":288,"y":176,"width":32,"height":32,"inputConnectorIDs":[71742],"outputConnectorIDs":[71741],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter Blank Elapsed Time"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"actual_elapsed_time"},"2":{"slot":2,"type":"STRING","value":"Not"},"3":{"slot":3,"type":"STRING","value":"Null"},"4":{"slot":4,"type":"STRING","value":""}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"71734":{"id":71734,"sourceID":71725,"targetID":71730},"71736":{"id":71736,"sourceID":71726,"targetID":71727},"71737":{"id":71737,"sourceID":71731,"targetID":71724},"71738":{"id":71738,"sourceID":71730,"targetID":71726},"71739":{"id":71739,"sourceID":71733,"targetID":71725},"71740":{"id":71740,"sourceID":71732,"targetID":71725},"71741":{"id":71741,"sourceID":71735,"targetID":71733},"71742":{"id":71742,"sourceID":71729,"targetID":71735},"71743":{"id":71743,"sourceID":71724,"targetID":71728},"71745":{"id":71745,"sourceID":71726,"targetID":71731}},"notes":{"71716":{"id":71716,"x":33,"y":55,"width":170,"height":283,"text":"**Multi Table input**\n\nTakes data from 3 views \ndb_source.vew_flights_2016\ndb_source.vew_flights_2017\ndb_source.vew_flights_2018\n\n\n\n\n\n\nThe 3 views are based on the db_source. training_sf_src_flights table.\nThe db_source. training_sf_src_flights table is loaded by the fixed iterator and S3 load. See the sub orchestration. ","colour":"e6e63c"},"71717":{"id":71717,"x":995,"y":123,"width":104,"height":95,"text":"**Rewrite Table Component**","colour":"e6e63c"},"71718":{"id":71718,"x":36,"y":-15,"width":145,"height":40,"text":"**``Load fct_flights_analysis``**","colour":"00ce4f"},"71719":{"id":71719,"x":223,"y":139,"width":133,"height":77,"text":"**Filter**","colour":"e6e63c"},"71720":{"id":71720,"x":997,"y":265,"width":104,"height":96,"text":"**Aggregate Component**","colour":"e6e63c"},"71721":{"id":71721,"x":1138,"y":267,"width":150,"height":93,"text":"**Table Output Component**","colour":"e6e63c"},"71722":{"id":71722,"x":356,"y":288,"width":129,"height":91,"text":"**Fixed Flow Component**\n\n","colour":"e6e63c"},"71723":{"id":71723,"x":388,"y":137,"width":119,"height":81,"text":"**Rank Component**","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"Load fct_flights_analysis","description":"Transformation job to populate the fct_flightsanalysis table from the stages S3 files","type":"TRANSFORMATION","tag":"14f50def-5fb6-4cef-94bc-f176f6d50903"}}