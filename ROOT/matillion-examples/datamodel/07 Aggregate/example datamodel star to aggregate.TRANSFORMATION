{"job":{"components":{"67416":{"id":67416,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":475,"y":156,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[67433],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_fan_status"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_fan_status"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"fan_status_key"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"fan_status_code"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"status"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${examples_schema}"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"67417":{"id":67417,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":370,"y":269,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[67429],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"fact_bubble_event"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"fact_bubble_event"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"ts"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"equipment_key"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"fan_status_key"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"date_key"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"hour_key"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${examples_schema}"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"67418":{"id":67418,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-629958239,"x":546,"y":269,"width":32,"height":32,"inputConnectorIDs":[67426,67429,67433],"outputConnectorIDs":[67428],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Join 0"}}}},"visible":true},"2":{"slot":2,"name":"Main Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"fact_bubble_event"}}}},"visible":true},"3":{"slot":3,"name":"Main Table Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"f"}}}},"visible":true},"4":{"slot":4,"name":"Joins","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_fan_status"},"2":{"slot":2,"type":"STRING","value":"df"},"3":{"slot":3,"type":"STRING","value":"Inner"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"dim_equipment"},"2":{"slot":2,"type":"STRING","value":"de"},"3":{"slot":3,"type":"STRING","value":"Inner"}}}},"visible":true},"5":{"slot":5,"name":"Join Expressions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"f\".\"fan_status_key\" = \"df\".\"fan_status_key\""},"2":{"slot":2,"type":"STRING","value":"f_Inner_df"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"\"f\".\"equipment_key\" = \"de\".\"equipment_key\""},"2":{"slot":2,"type":"STRING","value":"f_Inner_de"}}}},"visible":true},"6":{"slot":6,"name":"Output Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"f.id"},"2":{"slot":2,"type":"STRING","value":"id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"f.ts"},"2":{"slot":2,"type":"STRING","value":"ts"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"f.equipment_key"},"2":{"slot":2,"type":"STRING","value":"equipment_key"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"f.fan_status_key"},"2":{"slot":2,"type":"STRING","value":"fan_status_key"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"f.date_key"},"2":{"slot":2,"type":"STRING","value":"date_key"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"f.hour_key"},"2":{"slot":2,"type":"STRING","value":"hour_key"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"df.fan_status_code"},"2":{"slot":2,"type":"STRING","value":"fan_status_code"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"df.status"},"2":{"slot":2,"type":"STRING","value":"fan_status"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"de.equipment_id"},"2":{"slot":2,"type":"STRING","value":"equipment_id"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"de.name"},"2":{"slot":2,"type":"STRING","value":"equipment_name"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"67419":{"id":67419,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":482,"y":381,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[67426],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_equipment"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_equipment"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"equipment_key"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"equipment_id"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"name"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${examples_schema}"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"67420":{"id":67420,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1701703136,"x":802,"y":269,"width":32,"height":32,"inputConnectorIDs":[67427],"outputConnectorIDs":[67424],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Aggregate 0"}}}},"visible":true},"2":{"slot":2,"name":"Groupings","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"date_key"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"hour_key"}}}},"visible":true},"3":{"slot":3,"name":"Aggregations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"bubble_frequency_s"},"2":{"slot":2,"type":"STRING","value":"Average"}}}},"visible":true},"4":{"slot":4,"name":"Grouping Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Group By"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"67421":{"id":67421,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":674,"y":269,"width":32,"height":32,"inputConnectorIDs":[67428],"outputConnectorIDs":[67427],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calculator 0"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TIMESTAMPDIFF(millisecond,\n              LAG(\"ts\", 1) OVER (PARTITION BY \"equipment_key\" ORDER BY \"ts\"),\n              \"ts\")\n/ 1000.0"},"2":{"slot":2,"type":"STRING","value":"bubble_frequency_s"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"67422":{"id":67422,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":335239555,"x":1203,"y":273,"width":32,"height":32,"inputConnectorIDs":[67430],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rewrite agg_rate"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"agg_rate"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${examples_schema}"}}}},"visible":true},"8":{"slot":8,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"9":{"slot":9,"name":"Order By","elements":{},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"67423":{"id":67423,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":2139809017,"x":930,"y":269,"width":32,"height":32,"inputConnectorIDs":[67424],"outputConnectorIDs":[67431],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rank 0"}}}},"visible":true},"2":{"slot":2,"name":"Include input columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Partition Data","elements":{},"visible":true},"4":{"slot":4,"name":"Ordering within partitions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"date_key"},"2":{"slot":2,"type":"STRING","value":"Asc"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"hour_key"},"2":{"slot":2,"type":"STRING","value":"Asc"}}}},"visible":true},"5":{"slot":5,"name":"Functions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Row Number"},"2":{"slot":2,"type":"STRING","value":"hour_number"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"67425":{"id":67425,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":1059,"y":273,"width":32,"height":32,"inputConnectorIDs":[67431],"outputConnectorIDs":[67430],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Add natural log"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LN(60.0 / \"avg_bubble_frequency_s\")"},"2":{"slot":2,"type":"STRING","value":"ln_bpm"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"67424":{"id":67424,"sourceID":67420,"targetID":67423},"67426":{"id":67426,"sourceID":67419,"targetID":67418},"67427":{"id":67427,"sourceID":67421,"targetID":67420},"67428":{"id":67428,"sourceID":67418,"targetID":67421},"67429":{"id":67429,"sourceID":67417,"targetID":67418},"67430":{"id":67430,"sourceID":67425,"targetID":67422},"67431":{"id":67431,"sourceID":67423,"targetID":67425},"67433":{"id":67433,"sourceID":67416,"targetID":67418}},"notes":{"67412":{"id":67412,"x":731,"y":168,"width":147,"height":192,"text":"Aggregation takes the data volumes down from 144,560 rows to 176 rows","colour":"00ce4f"},"67413":{"id":67413,"x":931,"y":374,"width":294,"height":140,"text":"This is the data used for the statistical analysis in [[https://www.matillion.com/resources/developer-relations/analysis-of-exponential-decay-using-matillion-etl-for-delta-lake-on-databricks]]\n\nThe aggregated data is an exponential decay, whereas the natural log is a straight line that can be used with linear regression","colour":"00ce4f"},"67414":{"id":67414,"x":1134,"y":122,"width":339,"height":200,"text":"This is an \"Aggregate fact table\" – created by grouping an existing Fact table on a smaller number of Dimensions.\n\nIt is fully recreated every time, using a Rewrite Table component.\n\nMore information on Star Schema design at [[https://www.matillion.com/resources/blog/building-a-star-schema-with-matillion]]","colour":"00ce4f"},"67415":{"id":67415,"x":152,"y":78,"width":225,"height":115,"text":"``Run this job after completing 06 Star``\n\nYou should get the same results whether you used the 3NF or the Data Vault path\n\nThis job aggregates Star Schema data for statistical analysis","colour":"00ce4f"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"example datamodel star to aggregate","description":null,"type":"TRANSFORMATION","tag":"6eba7c14-367c-48db-9a0c-3548523ee8fc"}}