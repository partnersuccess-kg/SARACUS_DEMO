{"job":{"components":{"70624":{"id":70624,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-319648201,"x":1216,"y":128,"width":32,"height":32,"inputConnectorIDs":[70634],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create View 0"}}}},"visible":true},"2":{"slot":2,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"3":{"slot":3,"name":"View Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"trips_weather_agg"}}}},"visible":true},"5":{"slot":5,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Secure View","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"7":{"slot":7,"name":"View Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"70626":{"id":70626,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":2139809017,"x":592,"y":128,"width":32,"height":32,"inputConnectorIDs":[70641],"outputConnectorIDs":[70638],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Attribute Duplicate Counts"}}}},"visible":true},"2":{"slot":2,"name":"Include input columns.","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Partition Data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DATE_VALID_STD"}}}},"visible":true},"4":{"slot":4,"name":"Ordering within partitions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DATE_VALID_STD"},"2":{"slot":2,"type":"STRING","value":"Asc"}}}},"visible":true},"5":{"slot":5,"name":"Functions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Row Number"},"2":{"slot":2,"type":"STRING","value":"rn"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"70627":{"id":70627,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":864,"y":-80,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[70642],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"trips_combined"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TRIPS"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TRIPDURATION"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"STARTTIME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"STOPTIME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"START_STATION_ID"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"END_STATION_ID"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"BIKEID"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"USERTYPE"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"BIRTH_YEAR"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"GENDER"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEMO"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CITIBIKE"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"70628":{"id":70628,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1701703136,"x":1104,"y":128,"width":32,"height":32,"inputConnectorIDs":[70636],"outputConnectorIDs":[70634],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Aggregate Values"}}}},"visible":true},"2":{"slot":2,"name":"Groupings","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STARTTIME"}}}},"visible":true},"3":{"slot":3,"name":"Aggregations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TRIPDURATION"},"2":{"slot":2,"type":"STRING","value":"Count"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"TRIPDURATION"},"2":{"slot":2,"type":"STRING","value":"Average"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"AVG_TEMPERATURE_AIR_2M_F"},"2":{"slot":2,"type":"STRING","value":"Average"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"TOT_PRECIPITATION_IN"},"2":{"slot":2,"type":"STRING","value":"Average"}}}},"visible":true},"4":{"slot":4,"name":"Grouping Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Group By"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"70629":{"id":70629,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":992,"y":128,"width":32,"height":32,"inputConnectorIDs":[70640],"outputConnectorIDs":[70636],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Extract Month"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DATE_PART(day,\"DATE_VALID_STD\")"},"2":{"slot":2,"type":"STRING","value":"day"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"70630":{"id":70630,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":448,"y":128,"width":32,"height":32,"inputConnectorIDs":[70637],"outputConnectorIDs":[70641],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter NY Data"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STATE"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"New York"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"70631":{"id":70631,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-629958239,"x":870,"y":135,"width":32,"height":32,"inputConnectorIDs":[70639,70643],"outputConnectorIDs":[70640],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Join Weather & Trips"}}}},"visible":true},"2":{"slot":2,"name":"Main Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Convert to Date"}}}},"visible":true},"3":{"slot":3,"name":"Main Table Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"trips"}}}},"visible":true},"4":{"slot":4,"name":"Joins","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter 1st Result"},"2":{"slot":2,"type":"STRING","value":"weather"},"3":{"slot":3,"type":"STRING","value":"Inner"}}}},"visible":true},"5":{"slot":5,"name":"Join Expressions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"trips\".\"STARTTIME\" = \"weather\".\"DATE_VALID_STD\""},"2":{"slot":2,"type":"STRING","value":"trips_Inner_weather"}}}},"visible":true},"6":{"slot":6,"name":"Output Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"trips.TRIPDURATION"},"2":{"slot":2,"type":"STRING","value":"TRIPDURATION"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"trips.STARTTIME"},"2":{"slot":2,"type":"STRING","value":"STARTTIME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"weather.POSTAL_CODE"},"2":{"slot":2,"type":"STRING","value":"POSTAL_CODE"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"weather.DATE_VALID_STD"},"2":{"slot":2,"type":"STRING","value":"DATE_VALID_STD"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"weather.AVG_TEMPERATURE_AIR_2M_F"},"2":{"slot":2,"type":"STRING","value":"AVG_TEMPERATURE_AIR_2M_F"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"weather.TOT_PRECIPITATION_IN"},"2":{"slot":2,"type":"STRING","value":"TOT_PRECIPITATION_IN"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"70632":{"id":70632,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":320,"y":128,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[70637],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WEATHER_HISTORY_DAY"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"HISTORY_DAY"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"COUNTRY"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"POSTAL_CODE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"DATE_VALID_STD"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"DOY_STD"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"MIN_TEMPERATURE_AIR_2M_F"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"AVG_TEMPERATURE_AIR_2M_F"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"MAX_TEMPERATURE_AIR_2M_F"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"MIN_TEMPERATURE_WETBULB_2M_F"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"AVG_TEMPERATURE_WETBULB_2M_F"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"MAX_TEMPERATURE_WETBULB_2M_F"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"MIN_TEMPERATURE_DEWPOINT_2M_F"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"AVG_TEMPERATURE_DEWPOINT_2M_F"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"MAX_TEMPERATURE_DEWPOINT_2M_F"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"MIN_TEMPERATURE_FEELSLIKE_2M_F"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"AVG_TEMPERATURE_FEELSLIKE_2M_F"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"MAX_TEMPERATURE_FEELSLIKE_2M_F"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"MIN_TEMPERATURE_WINDCHILL_2M_F"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"AVG_TEMPERATURE_WINDCHILL_2M_F"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"MAX_TEMPERATURE_WINDCHILL_2M_F"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"MIN_TEMPERATURE_HEATINDEX_2M_F"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"AVG_TEMPERATURE_HEATINDEX_2M_F"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"MAX_TEMPERATURE_HEATINDEX_2M_F"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"MIN_HUMIDITY_RELATIVE_2M_PCT"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"AVG_HUMIDITY_RELATIVE_2M_PCT"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"MAX_HUMIDITY_RELATIVE_2M_PCT"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"MIN_HUMIDITY_SPECIFIC_2M_GPKG"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"AVG_HUMIDITY_SPECIFIC_2M_GPKG"}}},"28":{"slot":28,"values":{"1":{"slot":1,"type":"STRING","value":"MAX_HUMIDITY_SPECIFIC_2M_GPKG"}}},"29":{"slot":29,"values":{"1":{"slot":1,"type":"STRING","value":"MIN_PRESSURE_2M_MB"}}},"30":{"slot":30,"values":{"1":{"slot":1,"type":"STRING","value":"AVG_PRESSURE_2M_MB"}}},"31":{"slot":31,"values":{"1":{"slot":1,"type":"STRING","value":"MAX_PRESSURE_2M_MB"}}},"32":{"slot":32,"values":{"1":{"slot":1,"type":"STRING","value":"MIN_PRESSURE_TENDENCY_2M_MB"}}},"33":{"slot":33,"values":{"1":{"slot":1,"type":"STRING","value":"AVG_PRESSURE_TENDENCY_2M_MB"}}},"34":{"slot":34,"values":{"1":{"slot":1,"type":"STRING","value":"MAX_PRESSURE_TENDENCY_2M_MB"}}},"35":{"slot":35,"values":{"1":{"slot":1,"type":"STRING","value":"MIN_PRESSURE_MEAN_SEA_LEVEL_MB"}}},"36":{"slot":36,"values":{"1":{"slot":1,"type":"STRING","value":"AVG_PRESSURE_MEAN_SEA_LEVEL_MB"}}},"37":{"slot":37,"values":{"1":{"slot":1,"type":"STRING","value":"MAX_PRESSURE_MEAN_SEA_LEVEL_MB"}}},"38":{"slot":38,"values":{"1":{"slot":1,"type":"STRING","value":"MIN_WIND_SPEED_10M_MPH"}}},"39":{"slot":39,"values":{"1":{"slot":1,"type":"STRING","value":"AVG_WIND_SPEED_10M_MPH"}}},"40":{"slot":40,"values":{"1":{"slot":1,"type":"STRING","value":"MAX_WIND_SPEED_10M_MPH"}}},"41":{"slot":41,"values":{"1":{"slot":1,"type":"STRING","value":"AVG_WIND_DIRECTION_10M_DEG"}}},"42":{"slot":42,"values":{"1":{"slot":1,"type":"STRING","value":"MIN_WIND_SPEED_80M_MPH"}}},"43":{"slot":43,"values":{"1":{"slot":1,"type":"STRING","value":"AVG_WIND_SPEED_80M_MPH"}}},"44":{"slot":44,"values":{"1":{"slot":1,"type":"STRING","value":"MAX_WIND_SPEED_80M_MPH"}}},"45":{"slot":45,"values":{"1":{"slot":1,"type":"STRING","value":"AVG_WIND_DIRECTION_80M_DEG"}}},"46":{"slot":46,"values":{"1":{"slot":1,"type":"STRING","value":"MIN_WIND_SPEED_100M_MPH"}}},"47":{"slot":47,"values":{"1":{"slot":1,"type":"STRING","value":"AVG_WIND_SPEED_100M_MPH"}}},"48":{"slot":48,"values":{"1":{"slot":1,"type":"STRING","value":"MAX_WIND_SPEED_100M_MPH"}}},"49":{"slot":49,"values":{"1":{"slot":1,"type":"STRING","value":"AVG_WIND_DIRECTION_100M_DEG"}}},"50":{"slot":50,"values":{"1":{"slot":1,"type":"STRING","value":"TOT_PRECIPITATION_IN"}}},"51":{"slot":51,"values":{"1":{"slot":1,"type":"STRING","value":"TOT_SNOWFALL_IN"}}},"52":{"slot":52,"values":{"1":{"slot":1,"type":"STRING","value":"TOT_SNOWDEPTH_IN"}}},"53":{"slot":53,"values":{"1":{"slot":1,"type":"STRING","value":"MIN_CLOUD_COVER_TOT_PCT"}}},"54":{"slot":54,"values":{"1":{"slot":1,"type":"STRING","value":"AVG_CLOUD_COVER_TOT_PCT"}}},"55":{"slot":55,"values":{"1":{"slot":1,"type":"STRING","value":"MAX_CLOUD_COVER_TOT_PCT"}}},"56":{"slot":56,"values":{"1":{"slot":1,"type":"STRING","value":"MIN_RADIATION_SOLAR_TOTAL_WPM2"}}},"57":{"slot":57,"values":{"1":{"slot":1,"type":"STRING","value":"AVG_RADIATION_SOLAR_TOTAL_WPM2"}}},"58":{"slot":58,"values":{"1":{"slot":1,"type":"STRING","value":"MAX_RADIATION_SOLAR_TOTAL_WPM2"}}},"59":{"slot":59,"values":{"1":{"slot":1,"type":"STRING","value":"TOT_RADIATION_SOLAR_TOTAL_WPM2"}}},"60":{"slot":60,"values":{"1":{"slot":1,"type":"STRING","value":"STATE"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PUBLIC"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WEATHER"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"70633":{"id":70633,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1838652813,"x":864,"y":32,"width":32,"height":32,"inputConnectorIDs":[70642],"outputConnectorIDs":[70639],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Convert to Date"}}}},"visible":true},"2":{"slot":2,"name":"Conversions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STARTTIME"},"2":{"slot":2,"type":"STRING","value":"DATE"},"3":{"slot":3,"type":"INTEGER","value":""},"4":{"slot":4,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"70635":{"id":70635,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":720,"y":128,"width":32,"height":32,"inputConnectorIDs":[70638],"outputConnectorIDs":[70643],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter 1st Result"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STATE"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"New York"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"70634":{"id":70634,"sourceID":70628,"targetID":70624},"70636":{"id":70636,"sourceID":70629,"targetID":70628},"70637":{"id":70637,"sourceID":70632,"targetID":70630},"70638":{"id":70638,"sourceID":70626,"targetID":70635},"70639":{"id":70639,"sourceID":70633,"targetID":70631},"70640":{"id":70640,"sourceID":70631,"targetID":70629},"70641":{"id":70641,"sourceID":70630,"targetID":70626},"70642":{"id":70642,"sourceID":70627,"targetID":70633},"70643":{"id":70643,"sourceID":70635,"targetID":70631}},"notes":{"70620":{"id":70620,"x":248,"y":35,"width":147,"height":138,"text":"**WEATHERSOURCE_PARTNER_WS_ONPOINT_WEATHER_DATA_SHARE** \nfrom Snowflake Marketplace\n","colour":"f9c21b"},"70621":{"id":70621,"x":789,"y":-20,"width":151,"height":189,"text":"Convert starttime to a date and join on weather date","colour":"e6e63c"},"70622":{"id":70622,"x":518,"y":79,"width":249,"height":93,"text":"Remove duplicates","colour":"f9c21b"},"70623":{"id":70623,"x":249,"y":190,"width":995,"height":420,"text":"**__Talking Points__**\nBy this time, we have run **Citibike_transform_v3** to condense historical and operational data, as well as gained access to the WEATHERSOURCE_PARTNER_WS_ONPOINT_WEATHER_DATA_SHARE database from the Snowflake Marketplace. We are now ready to begin transforming the weather data into a usable state. Once complete, we will join to the **trips_combined** dataset to understand how temperature affects usage of the rental bikes.\n\n**WEATHER_HISTORY_DAY & trips_combined - Table Input components**\n- We are reading a table which contains records of regional weather data with information on temperature, precipitation, etc.\n- The other table being read - **trips_combined** - contains the TRIPS data we have been working on until this point.\n\n**Filter NY Data - Filter Component**\n- WEATHER_DAY is a table which contains records for many regions across the United States. Let's drill down our dataset to only include the records where NY is listed as the state.\n\n**Attribute Duplicate Counts - Rank Component**\n- We now want to ensure there is a single record per day of NY weather data. The first step in doing so is to use the Rank component, which creates a new field that begins at 1 and incrementally adds 1 to that figure in the presence of a duplicate date. Therefore, for each day there will be a single record with \"1\" in the rank field.\n\n**Filter 1st result - Filter Component**\n- After the rank is attributed, we now want to filter out only the 1s. Remember, each date in the dataset will have a single row with a 1 in the rank field. This filter will allow us to select a single description of the weather for each given day.\n\n**Convert to Date - Convert Type Component**\n- We want to join our **trips_combined** table to the weather dataset. The first step is ensuring the fields we are joining on have the same datatype. This component converts the STARTTIME field to a date.\n\n**Join Weather & Trips - Join Component**\n- This component performs an inner join, ensuring that the resulting dataset only contains matches on the date of the record, between the weather and trips datasets.\n\n**Extract Day - Calculator Component**\n- We now have a dataset which gives us records off each bike rental, now enriched with the weather conditions from that day. To calculate metrics on the daily activity around bike rentals, aggregation will be needed. We will first create a new field ","colour":"e6e63c"},"70625":{"id":70625,"x":412,"y":78,"width":87,"height":92,"text":"Filter **NY** Data","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"Citibike_transform2_v3 (1)","description":null,"type":"TRANSFORMATION","tag":"479b1ab3-9eee-4ebe-be10-20f3f0333ccf"}}