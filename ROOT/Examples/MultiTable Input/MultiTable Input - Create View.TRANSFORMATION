{"job":{"components":{"67778":{"id":67778,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-319648201,"x":1472,"y":224,"width":32,"height":32,"inputConnectorIDs":[67789],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create View 1"}}}},"visible":true},"2":{"slot":2,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"3":{"slot":3,"name":"View Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"vw_multitable_${table_pattern}_cols"}}}},"visible":true},"5":{"slot":5,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"67779":{"id":67779,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":736,"y":224,"width":32,"height":32,"inputConnectorIDs":[67785],"outputConnectorIDs":[67784],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calculator 0"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"REGEXP_REPLACE(REPLACE(REPLACE(\"COLUMN_NAME\", '['),']'),'\\\\) as ',')\" as \"',1,0)"},"2":{"slot":2,"type":"STRING","value":"COLUMN_SELECT"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"67780":{"id":67780,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":128170095,"x":1136,"y":224,"width":32,"height":32,"inputConnectorIDs":[67787],"outputConnectorIDs":[67789],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rename 0"}}}},"visible":true},"2":{"slot":2,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TABLE_SCHEMA"},"2":{"slot":2,"type":"STRING","value":"TABLE_SCHEMA"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"TABLE_NAME"},"2":{"slot":2,"type":"STRING","value":"TABLE_NAME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"COLUMN_SELECT"},"2":{"slot":2,"type":"STRING","value":"COLUMN_SELECT"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"67781":{"id":67781,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":288,"y":224,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[67786],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL 1"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT t.table_schema, \nt.table_name, \ncoalesce(c.column_name, 'cast(null as varchar(255))' || ' as ' || mc.\"column_name\") as column_name\nFROM \"multitable_column_list\" mc\nJOIN \"multitable_table_pattern\" mt on mc.\"table_schema\" = '${table_schema}' and mc.\"table_pattern\" = mt.\"table_pattern\"\njoin information_schema.tables t on mt.\"table_schema\" = t.table_schema and t.table_name like '${table_pattern}%'\nLEFT JOIN information_schema.columns c on t.table_schema = c.table_schema and t.table_name = c.table_name and mc.\"column_name\" = c.column_name"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"67782":{"id":67782,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-434984205,"x":512,"y":224,"width":32,"height":32,"inputConnectorIDs":[67786],"outputConnectorIDs":[67785],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Transpose Rows 0"}}}},"visible":true},"2":{"slot":2,"name":"Aggregations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"COLUMN_NAME"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Sort Order","elements":{},"visible":true},"5":{"slot":5,"name":"Groupings","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TABLE_SCHEMA"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"TABLE_NAME"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"67783":{"id":67783,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":880,"y":224,"width":32,"height":32,"inputConnectorIDs":[67784],"outputConnectorIDs":[67787],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calculator 1"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"IFF(\"COLUMN_SELECT\" like '%cast%',TRIM(REGEXP_SUBSTR(\"COLUMN_SELECT\", '\"cast(.*)\\\\)\"'),'\"'),\"COLUMN_SELECT\")"},"2":{"slot":2,"type":"STRING","value":"cast_field"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"IFF(\"COLUMN_SELECT\" like '%cast%',\n    REGEXP_REPLACE(\"COLUMN_SELECT\", '\"cast(.*)\\\\)\"',TRIM(REGEXP_SUBSTR(\"COLUMN_SELECT\", '\"cast(.*)\\\\)\"'),'\"')),\n    \"COLUMN_SELECT\"\n    )"},"2":{"slot":2,"type":"STRING","value":"COLUMN_SELECT"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"67784":{"id":67784,"sourceID":67779,"targetID":67783},"67785":{"id":67785,"sourceID":67782,"targetID":67779},"67786":{"id":67786,"sourceID":67781,"targetID":67782},"67787":{"id":67787,"sourceID":67783,"targetID":67780},"67789":{"id":67789,"sourceID":67780,"targetID":67778}},"notes":{"67772":{"id":67772,"x":1280,"y":59,"width":319,"height":237,"text":"Create a view that has one row per table that matches the table pattern.  View will be used to generate the final SQL.  Note that the ${table_pattern} variable is used as part of the view name.  This allows to have one view for every table pattern.","colour":"e6e63c"},"67773":{"id":67773,"x":127,"y":61,"width":267,"height":225,"text":"Driving SQL that uses the initialized metadata and Snowflake system tables to derive the list of columns to fetch from every table that matches the table pattern.  One row per table column.  \nIncludes logic to swap in the \"placeholder\" if a defined column does not exist in the table.  Logic is hardcoded to define any missing columns as a varchar(255).  This may need to be tweaked based on requirements.","colour":"e6e63c"},"67774":{"id":67774,"x":825,"y":58,"width":233,"height":233,"text":"Uses Snowflake functions to do additional format changes to ensure valid SQL.  Put logic in a second Calculator component for easier debugging and reading.","colour":"e6e63c"},"67775":{"id":67775,"x":1080,"y":58,"width":167,"height":234,"text":"Filter and rename colums.","colour":"e6e63c"},"67776":{"id":67776,"x":409,"y":59,"width":211,"height":227,"text":"Pivots the data and turns the columns in a comma delimited list.  Results in one row of data per table that matches the table pattern.","colour":"e6e63c"},"67777":{"id":67777,"x":638,"y":58,"width":172,"height":233,"text":"Uses Snowflake functions to remove square brackets from the column list.  Also adds logic to format the \"cast as\" syntax to be runnable in Snowflake (deals with double quotes).  ","colour":"e6e63c"}},"noteConnectors":{},"variables":{"table_pattern":{"definition":{"name":"table_pattern","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"orders_data"},"table_schema":{"definition":{"name":"table_schema","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"ARAWAN"}},"grids":{}},"info":{"name":"MultiTable Input - Create View","description":null,"type":"TRANSFORMATION","tag":"20b6d090-96a6-4888-8a1b-2b659e1c8c1d"}}