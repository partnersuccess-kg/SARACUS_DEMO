{"job":{"components":{"67758":{"id":67758,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-848,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[67766],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"67760":{"id":67760,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":-384,"y":0,"width":32,"height":32,"inputConnectorIDs":[67765],"outputSuccessConnectorIDs":[67767],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Query Result To Grid 0"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"4":{"slot":4,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select c.column_name, m.\"column_fnc_prefix\", m.\"column_fnc_suffix\"\nfrom information_schema.columns c\nleft join \"${jv_schema}\".\"meta_column_fnc_map_table\" m \non c.table_schema = m.\"schema_name\" and c.table_name = m.\"table_name\" and c.column_name = m.\"column_name\"\nwhere \nc.table_catalog = '${environment_database}' and\nc.table_schema = '${jv_schema}' and\nc.table_name = '${jv_table}'\n"}}}},"visible":true},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"gv_columns"}}}},"visible":true},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"COLUMN_NAME"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"column_fnc_prefix"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"column_fnc_suffix"}}}},"visible":true},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"67761":{"id":67761,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":208,"y":0,"width":32,"height":32,"inputConnectorIDs":[67764],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MetadataDrivenColumnFunctions - ApplySQL"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MetadataDrivenColumnFunctions - ApplySQL"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"jv_full_sql"},"2":{"slot":2,"type":"STRING","value":"${jv_full_sql}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"jv_table"},"2":{"slot":2,"type":"STRING","value":"${jv_table_name}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"jv_schema"},"2":{"slot":2,"type":"STRING","value":"${jv_schema}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"67762":{"id":67762,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-672,"y":0,"width":32,"height":32,"inputConnectorIDs":[67766],"outputSuccessConnectorIDs":[67765],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MetadataDrivenColumnFunctions - Initialize"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MetadataDrivenColumnFunctions - Initialize"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"67763":{"id":67763,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-144,"y":0,"width":32,"height":32,"inputConnectorIDs":[67767],"outputSuccessConnectorIDs":[67764],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python Script 0"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\n\n#print context.getGridVariable('gv_columns')\n\n# Define local Python Variables\nfull_sql = 'select\\r\\n'\ncolumn_list = []\n\n# Loop through Grid Variable and populate the \"column_list\" array\n# Wraps columns in LTRIM and RTRIM function calls.\n# Wraps column names in single quotes (quoted identifiers required by Snowflake)\n# Gives the column name an alias (same name as original column)\nfor ColumnName in context.getGridVariable('gv_columns'):\n    column_list.append(ColumnName[1] + '\\\"' + ColumnName[0] + '\\\"' + ColumnName[2] + ' as ' + ColumnName[0])\n\n# Add the column list to the SQL being built.  \n# Converts the column_list array into a comma delimited string. \n# Also appends new line to each column (for pretty output)\nfull_sql = full_sql + ',\\r\\n'.join(column_list)\n\n# Add the rest of the SQL\n# Double quotes around Database, Schema and Table as required by Snowflake\nfull_sql = full_sql + '\\r\\nFROM \\\"' + environment_database + '\\\".\\\"' + jv_schema + '\\\".\\\"' + jv_table + '\\\"'\n\ncontext.updateVariable('jv_full_sql',full_sql)\n\nprint jv_full_sql"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"67764":{"id":67764,"sourceID":67763,"targetID":67761},"67765":{"id":67765,"sourceID":67762,"targetID":67760},"67767":{"id":67767,"sourceID":67760,"targetID":67763}},"failureConnectors":{},"unconditionalConnectors":{"67766":{"id":67766,"sourceID":67758,"targetID":67762}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{"67754":{"id":67754,"x":-792,"y":-130,"width":272,"height":192,"text":"Initialize Metadata that defines the functions to apply to specific table columns.","colour":"e6e63c"},"67755":{"id":67755,"x":-230,"y":-129,"width":281,"height":181,"text":"Python Script builds a SQL statement dynamically. \nUses column names and function metadata from Grid Variable to define the generated SQL. ","colour":"e6e63c"},"67756":{"id":67756,"x":78,"y":-140,"width":265,"height":180,"text":"Call Transformation Job and pass in the current values of variables:\njv_full_sql\njv_table_name","colour":"e6e63c"},"67757":{"id":67757,"x":-740,"y":-257,"width":920,"height":82,"text":"This job demonstrates how to use metadata to dynamically apply functions to specific columns in a table. This particular job emulates a generic data cleansing workflow where the functions applied to columns represent the data cleansing logic.","colour":"00ce4f"},"67759":{"id":67759,"x":-483,"y":-123,"width":224,"height":173,"text":"Use Query Result to Grid to run SQL that joins metadata with system catalog data to populate into a Grid Variable","colour":"e6e63c"}},"variables":{"jv_full_sql":{"definition":{"name":"jv_full_sql","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"select 1 from dual"},"jv_schema":{"definition":{"name":"jv_schema","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"ARAWAN"},"jv_table":{"definition":{"name":"jv_table","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"raw_plane_info"}},"grids":{"gv_columns":{"definition":{"name":"gv_columns","scope":"BRANCH","definitions":[{"name":"column_name","type":"TEXT"},{"name":"column_fnc_prefix","type":"TEXT"},{"name":"column_fnc_suffix","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["col1","UPPER(",")"]}]}}},"info":{"name":"MetadataDrivenColumnFunctions - Main Orch","description":"","type":"ORCHESTRATION","tag":"72f8b76c-1a25-4fd0-8de6-dec3513a084b"}}